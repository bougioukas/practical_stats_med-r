<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.104">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Practical Statistics in Medicine with R - 32&nbsp; Survival analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./measurement_properties.html" rel="next">
<link href="./cochran.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/social-share.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/all.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.28/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="site_libs/dt-ext-buttons-1.13.4/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-buttons-1.13.4/js/dataTables.buttons.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.4/js/buttons.html5.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.4/js/buttons.colVis.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.4/js/buttons.print.min.js"></script><link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">Part 2: Statistics</a></li><li class="breadcrumb-item"><a href="./survival.html"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Survival analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical Statistics in Medicine with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bougioukas/practical_stats_med-r" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part 1: R Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R via RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstudio_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with RStudio Projects and writing R scripts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R as calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures in R: 1-Dimensional Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data structures in R: matrices and arrays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data structures in R: lists and data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Statistics and data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Basic concepts of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Foundations for statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Two-sample t-test (Student’s t-test)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wmw_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wilcoxon-Mann-Whitney (Mann-Whitney U) test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wilcoxon_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wilcoxon Signed-Rank test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">One-way ANOVA test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kruskal_wallis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Kruskal-Wallis test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Repeated Measures ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Friedman test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi_square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Chi-sqaure test of independence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fisher_exact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fisher’s exact test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mcnemar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">McNemar’s test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cochran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cochran’s Q Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurement_properties.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Measurement properties</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diagnostic_accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Measures of diagnostic test accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Receiver Operating Characteristic (ROC) curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Sample size calculation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#research-question" id="toc-research-question" class="nav-link active" data-scroll-target="#research-question"><span class="header-section-number">32.1</span> Research question</a></li>
  <li><a href="#packages-we-need" id="toc-packages-we-need" class="nav-link" data-scroll-target="#packages-we-need"><span class="header-section-number">32.2</span> Packages we need</a></li>
  <li><a href="#preraring-the-data" id="toc-preraring-the-data" class="nav-link" data-scroll-target="#preraring-the-data"><span class="header-section-number">32.3</span> Preraring the data</a></li>
  <li>
<a href="#the-kaplanmeier-product-limit-estimator" id="toc-the-kaplanmeier-product-limit-estimator" class="nav-link" data-scroll-target="#the-kaplanmeier-product-limit-estimator"><span class="header-section-number">32.4</span> The Kaplan–Meier Product Limit Estimator</a>
  <ul class="collapse">
<li><a href="#basic-concepts" id="toc-basic-concepts" class="nav-link" data-scroll-target="#basic-concepts">Basic concepts</a></li>
  <li><a href="#k-m-analysis-for-the-group-of-patients-in-new-therapy-a" id="toc-k-m-analysis-for-the-group-of-patients-in-new-therapy-a" class="nav-link" data-scroll-target="#k-m-analysis-for-the-group-of-patients-in-new-therapy-a">K-M analysis for the group of patients in new therapy A</a></li>
  <li><a href="#the-kaplanmeier-curve" id="toc-the-kaplanmeier-curve" class="nav-link" data-scroll-target="#the-kaplanmeier-curve">The Kaplan–Meier curve</a></li>
  </ul>
</li>
  <li><a href="#comparing-survival-curves" id="toc-comparing-survival-curves" class="nav-link" data-scroll-target="#comparing-survival-curves"><span class="header-section-number">32.5</span> Comparing survival curves</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-survival" class="quarto-section-identifier"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>The primary outcome in many clinical trials is the time from randomization, and start of the intervention to a well-defined critical event such as death, disease recurrence, occurrence of adverse events, or treatment failure. The survival analysis estimated by Kaplan–Meier approach is particularly useful when studying time-to-event data. It is a non-parametric method, which means that it does not make any assumptions about the underlying distribution of the data.</p>
<p>When we have finished this Chapter, we should be able to:</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Understand the basic concepts of the Kaplan-Meier analysis of time-to-event data</li>
<li>Compare different survival curves</li>
<li>Interpret the results</li>
</ul>
</div>
</div>
<section id="research-question" class="level2" data-number="32.1"><h2 data-number="32.1" class="anchored" data-anchor-id="research-question">
<span class="header-section-number">32.1</span> Research question</h2>
<p>In a randomized controlled trial of a new therapy A with data patients with leukemia, we want to:</p>
<ul>
<li>find the survival time of patients receiving the new therapy A</li>
<li>compare the survival curves of the patients receiving the new therapy A and patients receiving the standard therapy B for leukemia.</li>
</ul></section><section id="packages-we-need" class="level2" data-number="32.2"><h2 data-number="32.2" class="anchored" data-anchor-id="packages-we-need">
<span class="header-section-number">32.2</span> Packages we need</h2>
<p>We need to load the following packages:</p>
<div class="cell">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># packages for graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/ggsurvfit">ggsurvfit</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://csdaw.github.io/ggprism/">ggprism</a></span><span class="op">)</span></span>
<span><span class="co">#library(survminer)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">asaur</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jthomasmock/gtExtras">gtExtras</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="preraring-the-data" class="level2" data-number="32.3"><h2 data-number="32.3" class="anchored" data-anchor-id="preraring-the-data">
<span class="header-section-number">32.3</span> Preraring the data</h2>
<p>In preparing Kaplan-Meier survival analysis that compares different treatments, three variables should be recorded for each patient: (a) the <strong>time</strong> that is the duration between the beginning of the treatment and the end-point (event of interest or censoring), (b) the <strong>status</strong> at the end of the survival time (event occurrence or censored data), and (c) the <strong>study group</strong> such as treatment versus control intervention.</p>
<p>We import the data <em>“leukemia”</em> in R:</p>
<div class="cell">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"leukemia.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="fig-depression" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6995efa7641ea8681f15" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6995efa7641ea8681f15">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42"],[6,6,6,6,7,9,10,10,11,13,16,17,19,20,22,23,25,32,32,34,35,1,1,2,2,3,4,4,5,5,8,8,8,9,11,11,12,12,15,17,22,23],[0,1,1,1,1,0,0,1,0,1,1,0,0,0,1,1,0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1],["therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy A (new)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)","therapy B (standard)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>time<\/th>\n      <th>status<\/th>\n      <th>intervention<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><figcaption class="figure-caption">Figure&nbsp;32.1: Table with data from “leukemia” file.</figcaption></figure>
</div>
</div>
<p>The dataset has 42 observations (rows) and includes three variables (columns).</p>
<ul>
<li><p><strong>time:</strong> the survival or censoring time in months</p></li>
<li><p><strong>status:</strong> indicator whether or not the patient died (1 indicates death and 0 indicates censored observation)</p></li>
<li><p><strong>intervention:</strong> randomly assigned therapy group with two levels, A (new therapy) or B (standard therapy).</p></li>
</ul>
<p>We inspect the data and the type of variables:</p>
<div class="cell">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Rows: 42
Columns: 3
$ time         &lt;dbl&gt; 6, 6, 6, 6, 7, 9, 10, 10, 11, 13, 16, 17, 19, 20, 22, 23,…
$ status       &lt;dbl&gt; 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, …
$ intervention &lt;chr&gt; "therapy A (new)", "therapy A (new)", "therapy A (new)", …</code></pre>
</div>
</div>
<p>First, we obtain a subset of data with patients receiving the new therapy A.</p>
<div class="cell">
<div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat.A</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">intervention</span> <span class="op">==</span> <span class="st">"therapy A (new)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we run the <strong><code><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv()</a></code></strong> function that converts the data to a special format which allows to account for censored observations. The arguments we need to define are the <em>time</em> and the <em>health status</em> of the patients. The times (in months) for the patients receiving the new therapy A follow:</p>
<div class="cell">
<div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">dat.A</span><span class="op">$</span><span class="va">time</span>, <span class="va">dat.A</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1]  6+  6   6   6   7   9+ 10+ 10  11+ 13  16  17+ 19+ 20+ 22  23  25+ 32+ 32+
[20] 34+ 35+</code></pre>
</div>
</div>
<p><strong>NOTE:</strong> Censoring times are marked with <strong>+</strong> symbol. The above data show that patients in the new therapy were censored on months 6+, 9+, 10+, 11+, 17+, 19+, 20+, 32+, 32+, 34+, 35+.</p>
</section><section id="the-kaplanmeier-product-limit-estimator" class="level2" data-number="32.4"><h2 data-number="32.4" class="anchored" data-anchor-id="the-kaplanmeier-product-limit-estimator">
<span class="header-section-number">32.4</span> The Kaplan–Meier Product Limit Estimator</h2>
<p>Kaplan-Meier estimator, also known as product-limit estimator, can be used to measure the cumulative probability of “surviving” for a certain amount of time after starting the therapy.</p>
<section id="basic-concepts" class="level3"><h3 class="anchored" data-anchor-id="basic-concepts">Basic concepts</h3>
<p>Let <span class="math inline">\(T\)</span> be a non-negative random variable, representing the time until the event of interest (death). Additionally, suppose that the events (deaths) are observed in the period of follow-up at <span class="math inline">\(k\)</span> distinct times <span class="math inline">\(t_{1} &lt; t_{2} &lt; t_{3} &lt; \ ...\ &lt; t_{k}\)</span>. The <strong>conditional survival probability</strong> at <span class="math inline">\(t_j\)</span> is defined as the probability of surviving beyond time <span class="math inline">\(t_j\)</span> (<span class="math inline">\(T&gt;t_j\)</span>), given that the patient has survived at least <span class="math inline">\(t_j\)</span> time (<span class="math inline">\(T≥t_j\)</span>). This conditional probability represents the proportion of patients who are at risk at time <span class="math inline">\(t_j\)</span> but who do not die at this time point, as follows:</p>
<p><span id="eq-cond_prob"><span class="math display">\[P(T &gt; t_j\ |\ T≥t_{j})  = \frac{r_{j}-d_{j}}{r_{j}}\ = 1-\frac{d_{j}}{r_{j}} , \ \ \ for\ j=1,2,..,k.  \tag{32.1}\]</span></span></p>
<p>where</p>
<p><span class="math inline">\(t_{j}\)</span> is the time when at least one event (i.e., death) happened</p>
<p><span class="math inline">\(r_j\)</span> is the number of patients at risk (i.e., the number of patients alive) just before the time <span class="math inline">\(t_j\)</span></p>
<p><span class="math inline">\(d_j\)</span> the number of events (i.e., deaths) that happened at time <span class="math inline">\(t_j\)</span></p>
<p>&nbsp;</p>
<p>The <strong>Kaplan–Meier estimator</strong> for the survival function is defined as the <strong>cumulative product</strong> of the conditional survival probabilities:</p>
<p><span id="eq-cum_surv1"><span class="math display">\[ S(t) = P(T&gt;t)  =  \prod_{j:t_j≤t}(1-\frac{d_{j}}{r_{j}}) \tag{32.2}\]</span></span></p>
<p>Therefore, the cumulative probability of surviving beyond <span class="math inline">\(t_j\)</span> is given by:</p>
<p><span id="eq-cum_surv2"><span class="math display">\[ S(t_{j}) = (1-\frac{d_{j}}{r_{j}}) \times (1-\frac{d_{j-1}}{r_{j-1}})   \times \ ... \times\ (1-\frac{d_{2}}{r_{2}}) \times (1-\frac{d_{1}}{r_{1}})  \tag{32.3}\]</span></span></p>
<p>This implies that:</p>
<p><span id="eq-cum_surv3"><span class="math display">\[ S(t_{j}) =  (1-\frac{d_{j}}{r_{j}}) \times S(t_{j-1})  \tag{32.4}\]</span></span></p>
</section><section id="k-m-analysis-for-the-group-of-patients-in-new-therapy-a" class="level3"><h3 class="anchored" data-anchor-id="k-m-analysis-for-the-group-of-patients-in-new-therapy-a">K-M analysis for the group of patients in new therapy A</h3>
<p>The first step in Kaplan-Meier analysis usually involves the construction of a table with pertinent information, so we call the <code><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html">survfit2()</a></code> function that models the survival probability</p>
<p>by fitting the “survival” data of new therapy A to a constant (since there is only one group).</p>
<div class="cell">
<div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create an object with the K-M estimates for the patients in the new therapy A</span></span>
<span><span class="va">km.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html">survfit2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">dat.A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">km.A</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] "n"            "time"         "n.risk"       "n.event"      "n.censor"    
 [6] "surv"         "std.err"      "cumhaz"       "std.chaz"     "type"        
[11] "logse"        "conf.int"     "conf.type"    "lower"        "upper"       
[16] "call"         ".Environment"</code></pre>
</div>
</div>
<p>The object <code>km.A</code> includes the number of participants at risk (<code>n.risk</code>), censored (<code>n.censor</code>) and having experienced an event (<code>n.event</code>) as well as the cumulative probability of surviving over time (<code>surv</code>) for the new therapy, among others.</p>
<p>Next, we estimate in R the conditional probability of surviving over time using the <a href="#eq-cond_prob" class="quarto-xref">Equation&nbsp;<span>32.1</span></a>:</p>
<div class="cell">
<div class="sourceCode" id="cb10" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute the probability of "surviving" over time</span></span>
<span><span class="va">prob.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="va">km.A</span><span class="op">$</span><span class="va">n.event</span><span class="op">/</span><span class="va">km.A</span><span class="op">$</span><span class="va">n.risk</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">prob.A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> [1] 0.857 0.941 1.000 0.933 1.000 0.917 0.909 1.000 1.000 1.000 0.857 0.833
[13] 1.000 1.000 1.000 1.000</code></pre>
</div>
</div>
<p>&nbsp;</p>
<p>Now, we are ready to include all the information in one table (<a href="#tbl-tb1" class="quarto-xref">Table&nbsp;<span>32.1</span></a>) as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># create a dataframe with all the "survival" variables of interest</span></span>
<span><span class="va">tb.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">km.A</span><span class="op">$</span><span class="va">time</span>, n.risk <span class="op">=</span> <span class="va">km.A</span><span class="op">$</span><span class="va">n.risk</span>,</span>
<span>                   n.event <span class="op">=</span> <span class="va">km.A</span><span class="op">$</span><span class="va">n.event</span>, n.censor <span class="op">=</span> <span class="va">km.A</span><span class="op">$</span><span class="va">n.censor</span>,</span>
<span>                   <span class="va">prob.A</span>, surv.A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">km.A</span><span class="op">$</span><span class="va">surv</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create the table</span></span>
<span><span class="va">tb.A</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html">cols_label</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Ordered times (months), t"</span><span class="op">)</span>,</span>
<span>  n.risk <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"No. at risk"</span><span class="op">)</span>,</span>
<span>  n.event <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"No. of deaths"</span><span class="op">)</span>,  </span>
<span>  n.censor <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"No. censored"</span><span class="op">)</span>,</span>
<span>  prob.A <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Conditional probability of surviving, P(t)"</span><span class="op">)</span>,</span>
<span>  surv.A <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Cumulative probability of surviving, S(t)"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html">tab_options</a></span><span class="op">(</span>column_labels.font.weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_align.html">cols_align</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://jthomasmock.github.io/gtExtras/reference/gt_highlight_rows.html">gt_highlight_rows</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"lightgrey"</span>,</span>
<span>                    bold_target_only <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    target_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n.risk</span>, <span class="va">n.censor</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html">tab_style</a></span><span class="op">(</span>style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://gt.rstudio.com/reference/cell_text.html">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            locations <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html">cells_body</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="va">n.risk</span>, rows <span class="op">=</span> <span class="va">n.risk</span> <span class="op">==</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-tb1" class="anchored">
<div id="rtprkycnjp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rtprkycnjp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rtprkycnjp thead, #rtprkycnjp tbody, #rtprkycnjp tfoot, #rtprkycnjp tr, #rtprkycnjp td, #rtprkycnjp th {
  border-style: none;
}

#rtprkycnjp p {
  margin: 0;
  padding: 0;
}

#rtprkycnjp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rtprkycnjp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rtprkycnjp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rtprkycnjp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rtprkycnjp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtprkycnjp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtprkycnjp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rtprkycnjp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rtprkycnjp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rtprkycnjp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rtprkycnjp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rtprkycnjp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rtprkycnjp .gt_spanner_row {
  border-bottom-style: hidden;
}

#rtprkycnjp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rtprkycnjp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rtprkycnjp .gt_from_md > :first-child {
  margin-top: 0;
}

#rtprkycnjp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rtprkycnjp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rtprkycnjp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rtprkycnjp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rtprkycnjp .gt_row_group_first td {
  border-top-width: 2px;
}

#rtprkycnjp .gt_row_group_first th {
  border-top-width: 2px;
}

#rtprkycnjp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtprkycnjp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rtprkycnjp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rtprkycnjp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtprkycnjp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtprkycnjp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rtprkycnjp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rtprkycnjp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rtprkycnjp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rtprkycnjp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtprkycnjp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtprkycnjp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rtprkycnjp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rtprkycnjp .gt_left {
  text-align: left;
}

#rtprkycnjp .gt_center {
  text-align: center;
}

#rtprkycnjp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rtprkycnjp .gt_font_normal {
  font-weight: normal;
}

#rtprkycnjp .gt_font_bold {
  font-weight: bold;
}

#rtprkycnjp .gt_font_italic {
  font-style: italic;
}

#rtprkycnjp .gt_super {
  font-size: 65%;
}

#rtprkycnjp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rtprkycnjp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rtprkycnjp .gt_indent_1 {
  text-indent: 5px;
}

#rtprkycnjp .gt_indent_2 {
  text-indent: 10px;
}

#rtprkycnjp .gt_indent_3 {
  text-indent: 15px;
}

#rtprkycnjp .gt_indent_4 {
  text-indent: 20px;
}

#rtprkycnjp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption>Table&nbsp;32.1:  <p>sdf sfsf</p> </caption>
  <thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Ordered times (months), t">Ordered times (months), t</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="No. at risk">No. at risk</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="No. of deaths">No. of deaths</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="No. censored">No. censored</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Conditional probability of surviving, P(t)">Conditional probability of surviving, P(t)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Cumulative probability of surviving, S(t)">Cumulative probability of surviving, S(t)</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="time" class="gt_row gt_center">6</td>
<td headers="n.risk" class="gt_row gt_center">21</td>
<td headers="n.event" class="gt_row gt_center">3</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.857</td>
<td headers="surv.A" class="gt_row gt_center">0.857</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">7</td>
<td headers="n.risk" class="gt_row gt_center">17</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">0</td>
<td headers="prob.A" class="gt_row gt_center">0.941</td>
<td headers="surv.A" class="gt_row gt_center">0.807</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8);">9</td>
<td headers="n.risk" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8); color: #000000; font-weight: bold;">16</td>
<td headers="n.event" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8);">0</td>
<td headers="n.censor" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8); color: #000000; font-weight: bold;">1</td>
<td headers="prob.A" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8);">1.000</td>
<td headers="surv.A" class="gt_row gt_center" style="background-color: rgba(211,211,211,0.8);">0.807</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">10</td>
<td headers="n.risk" class="gt_row gt_center" style="font-weight: bold;">15</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.933</td>
<td headers="surv.A" class="gt_row gt_center">0.753</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">11</td>
<td headers="n.risk" class="gt_row gt_center">13</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.753</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">13</td>
<td headers="n.risk" class="gt_row gt_center">12</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">0</td>
<td headers="prob.A" class="gt_row gt_center">0.917</td>
<td headers="surv.A" class="gt_row gt_center">0.690</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">16</td>
<td headers="n.risk" class="gt_row gt_center">11</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">0</td>
<td headers="prob.A" class="gt_row gt_center">0.909</td>
<td headers="surv.A" class="gt_row gt_center">0.627</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">17</td>
<td headers="n.risk" class="gt_row gt_center">10</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.627</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">19</td>
<td headers="n.risk" class="gt_row gt_center">9</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.627</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">20</td>
<td headers="n.risk" class="gt_row gt_center">8</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.627</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">22</td>
<td headers="n.risk" class="gt_row gt_center">7</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">0</td>
<td headers="prob.A" class="gt_row gt_center">0.857</td>
<td headers="surv.A" class="gt_row gt_center">0.538</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">23</td>
<td headers="n.risk" class="gt_row gt_center">6</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="n.censor" class="gt_row gt_center">0</td>
<td headers="prob.A" class="gt_row gt_center">0.833</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">25</td>
<td headers="n.risk" class="gt_row gt_center">5</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">32</td>
<td headers="n.risk" class="gt_row gt_center">4</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">2</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">34</td>
<td headers="n.risk" class="gt_row gt_center">2</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
</tr>
<tr>
<td headers="time" class="gt_row gt_center">35</td>
<td headers="n.risk" class="gt_row gt_center">1</td>
<td headers="n.event" class="gt_row gt_center">0</td>
<td headers="n.censor" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">1.000</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>When there are only censored observations at a particular time such as at month 9, the conditional probability <span class="math inline">\(P(t)\)</span> of surviving equals to 1 and the cumulative probability <span class="math inline">\(S(t)\)</span> does not changed. However, we observe that at the next time t = 10 months, the number of patients “at risk” is reduced by the number of censored data at t = 9 months (16 - 1 = 15).</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Censoring removes the subject from the denominator, i.e., patients at risk.</p>
</div>
</div>
<p>To calculate the conditional survival probability <span class="math inline">\(P(t)\)</span>, we consider the numerator as the difference between the number of patients at risk and the number of patients who died and at the denominator the number of patients at risk at the beginning of the period. For the first two periods, we have:</p>
<p>0-6 In this study 21 patients were at risk at therapy A. All patients were alive; the proportion surviving on this day and the cumulative survival (i.e.&nbsp;proportion of all cases that were still alive at this day) were both 1.</p>
<p>We can see that at day 0, there are 61 patients in the combination therapy group at risk and one patient have been censored. If there are not relapses the <span class="math inline">\(S(t_{0}) = S(0) = 1\)</span>.</p>
<p>At day 1 there are 60 patients at risk and one patient have been censored. If there are not relapses the <span class="math inline">\(S(t_{0}) = S(0) = 1\)</span>.</p>
<p><span class="math inline">\(S(t_{}) = S(t_{4}) \times P(t_{5}) = 0.916 \times 0.962 = 0.881\)</span></p>
<p>We observe that at day 1, the curve drops 16% of the remaining height (instead of 10% at the start of the study), because less people are at risk:</p>
<p>For example, in the combination therapy group, the cumulative probability of a patient to be relapse-free 5 days <span class="math inline">\(S(t_{5})\)</span>, is the cumulative probability of being relapse-free the first 4 days <span class="math inline">\(S(t_{4}) = 0.916\)</span> multiplied by the probability of being relapse-free the interval between 4 and 5 days <span class="math inline">\(P(t_{5}) = 0.962\)</span>:</p>
<p><span class="math inline">\(S(t_{5}) = S(t_{4}) \times P(t_{5}) = 0.916 \times 0.962 = 0.881\)</span></p>
<p>We can see that at day 1, there are 61 patients in the combination therapy group at risk and one patient have been censored. We observe that at day 1, the curve drops 16% of the remaining height (instead of 10% at the start of the study), because less people are at risk:</p>
</section><section id="the-kaplanmeier-curve" class="level3"><h3 class="anchored" data-anchor-id="the-kaplanmeier-curve">The Kaplan–Meier curve</h3>
<p>Kaplan-Meier analysis can be presented as a survival curve in addition to tabular form.</p>
<p>Kaplan–Meier curves are widely used for the visual representation of survival function (estimated by Kaplan–Meier estimator).</p>
<p>The table presents at each time <span class="math inline">\(t_j\)</span> in which an event occurred, the total number of patients at risk (<span class="math inline">\(r_j\)</span>) just before the <span class="math inline">\(t_j\)</span>, the number of events at that time (<span class="math inline">\(d_j\)</span>), the conditional probability and the cumulative probability of surviving with 95% confidence interval (lower 95% CI, upper 95% CI).</p>
<div class="cell">
<div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tb.km.A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">tb.A</span>, LCL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">km.A</span><span class="op">$</span><span class="va">lower</span>, <span class="fl">3</span><span class="op">)</span>, UCL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">km.A</span><span class="op">$</span><span class="va">upper</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tb.km.A</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n.censor</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">prob.A</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>j <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html">cols_label</a></span><span class="op">(</span></span>
<span>    time <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Survival times (months), t&lt;sub&gt;j&lt;/sub&gt;"</span><span class="op">)</span>,</span>
<span>    n.risk <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"No. at risk, r&lt;sub&gt;j&lt;/sup&gt;"</span><span class="op">)</span>,</span>
<span>    n.event <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"No. of deaths, d&lt;sub&gt;j&lt;/sup&gt;"</span><span class="op">)</span>,</span>
<span>    prob.A <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Conditional probability of surviving, P(t&lt;sub&gt;j&lt;/sub&gt;)"</span><span class="op">)</span>,</span>
<span>    surv.A <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"Cumulative probability of surviving, S(t&lt;sub&gt;j&lt;/sub&gt;)"</span><span class="op">)</span>,</span>
<span>    LCL <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"lower 95% CI"</span><span class="op">)</span>,</span>
<span>    UCL <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/html.html">html</a></span><span class="op">(</span><span class="st">"upper 95% CI"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html">tab_options</a></span><span class="op">(</span>column_labels.font.weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_align.html">cols_align</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ydsfzjgwxa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ydsfzjgwxa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ydsfzjgwxa thead, #ydsfzjgwxa tbody, #ydsfzjgwxa tfoot, #ydsfzjgwxa tr, #ydsfzjgwxa td, #ydsfzjgwxa th {
  border-style: none;
}

#ydsfzjgwxa p {
  margin: 0;
  padding: 0;
}

#ydsfzjgwxa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ydsfzjgwxa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ydsfzjgwxa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ydsfzjgwxa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ydsfzjgwxa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydsfzjgwxa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydsfzjgwxa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydsfzjgwxa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ydsfzjgwxa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ydsfzjgwxa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ydsfzjgwxa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ydsfzjgwxa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ydsfzjgwxa .gt_spanner_row {
  border-bottom-style: hidden;
}

#ydsfzjgwxa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ydsfzjgwxa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ydsfzjgwxa .gt_from_md > :first-child {
  margin-top: 0;
}

#ydsfzjgwxa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ydsfzjgwxa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ydsfzjgwxa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ydsfzjgwxa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ydsfzjgwxa .gt_row_group_first td {
  border-top-width: 2px;
}

#ydsfzjgwxa .gt_row_group_first th {
  border-top-width: 2px;
}

#ydsfzjgwxa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydsfzjgwxa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ydsfzjgwxa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ydsfzjgwxa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydsfzjgwxa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydsfzjgwxa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ydsfzjgwxa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ydsfzjgwxa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ydsfzjgwxa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydsfzjgwxa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydsfzjgwxa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydsfzjgwxa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydsfzjgwxa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydsfzjgwxa .gt_left {
  text-align: left;
}

#ydsfzjgwxa .gt_center {
  text-align: center;
}

#ydsfzjgwxa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ydsfzjgwxa .gt_font_normal {
  font-weight: normal;
}

#ydsfzjgwxa .gt_font_bold {
  font-weight: bold;
}

#ydsfzjgwxa .gt_font_italic {
  font-style: italic;
}

#ydsfzjgwxa .gt_super {
  font-size: 65%;
}

#ydsfzjgwxa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ydsfzjgwxa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ydsfzjgwxa .gt_indent_1 {
  text-indent: 5px;
}

#ydsfzjgwxa .gt_indent_2 {
  text-indent: 10px;
}

#ydsfzjgwxa .gt_indent_3 {
  text-indent: 15px;
}

#ydsfzjgwxa .gt_indent_4 {
  text-indent: 20px;
}

#ydsfzjgwxa .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="j">j</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Survival times (months), t<sub>j</sub>">Survival times (months), t<sub>j</sub>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="No. at risk, r<sub>j</sup>">No. at risk, r<sub>j</sub>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="No. of deaths, d<sub>j</sup>">No. of deaths, d<sub>j</sub>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Conditional probability of surviving, P(t<sub>j</sub>)">Conditional probability of surviving, P(t<sub>j</sub>)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Cumulative probability of surviving, S(t<sub>j</sub>)">Cumulative probability of surviving, S(t<sub>j</sub>)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="lower 95% CI">lower 95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="upper 95% CI">upper 95% CI</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="j" class="gt_row gt_center">1</td>
<td headers="time" class="gt_row gt_center">6</td>
<td headers="n.risk" class="gt_row gt_center">21</td>
<td headers="n.event" class="gt_row gt_center">3</td>
<td headers="prob.A" class="gt_row gt_center">0.857</td>
<td headers="surv.A" class="gt_row gt_center">0.857</td>
<td headers="LCL" class="gt_row gt_center">0.720</td>
<td headers="UCL" class="gt_row gt_center">1.000</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">2</td>
<td headers="time" class="gt_row gt_center">7</td>
<td headers="n.risk" class="gt_row gt_center">17</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.941</td>
<td headers="surv.A" class="gt_row gt_center">0.807</td>
<td headers="LCL" class="gt_row gt_center">0.653</td>
<td headers="UCL" class="gt_row gt_center">0.996</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">3</td>
<td headers="time" class="gt_row gt_center">10</td>
<td headers="n.risk" class="gt_row gt_center">15</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.933</td>
<td headers="surv.A" class="gt_row gt_center">0.753</td>
<td headers="LCL" class="gt_row gt_center">0.586</td>
<td headers="UCL" class="gt_row gt_center">0.968</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">4</td>
<td headers="time" class="gt_row gt_center">13</td>
<td headers="n.risk" class="gt_row gt_center">12</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.917</td>
<td headers="surv.A" class="gt_row gt_center">0.690</td>
<td headers="LCL" class="gt_row gt_center">0.510</td>
<td headers="UCL" class="gt_row gt_center">0.935</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">5</td>
<td headers="time" class="gt_row gt_center">16</td>
<td headers="n.risk" class="gt_row gt_center">11</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.909</td>
<td headers="surv.A" class="gt_row gt_center">0.627</td>
<td headers="LCL" class="gt_row gt_center">0.439</td>
<td headers="UCL" class="gt_row gt_center">0.896</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">6</td>
<td headers="time" class="gt_row gt_center">22</td>
<td headers="n.risk" class="gt_row gt_center">7</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.857</td>
<td headers="surv.A" class="gt_row gt_center">0.538</td>
<td headers="LCL" class="gt_row gt_center">0.337</td>
<td headers="UCL" class="gt_row gt_center">0.858</td>
</tr>
<tr>
<td headers="j" class="gt_row gt_center">7</td>
<td headers="time" class="gt_row gt_center">23</td>
<td headers="n.risk" class="gt_row gt_center">6</td>
<td headers="n.event" class="gt_row gt_center">1</td>
<td headers="prob.A" class="gt_row gt_center">0.833</td>
<td headers="surv.A" class="gt_row gt_center">0.448</td>
<td headers="LCL" class="gt_row gt_center">0.249</td>
<td headers="UCL" class="gt_row gt_center">0.807</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Survival Probability Calculation: The survival probability is calculated at each time interval. It represents the proportion of subjects who have not experienced the event up to that point in time. The initial survival probability is 1 (i.e., all subjects are event-free at the start).</p>
<p>Cumulative Survival Probability:</p>
<p>the proportion of patients free from tobacco up to <span class="math inline">\(j\)</span> point in time is <span class="math inline">\(S(t_{j-1})\)</span> is multiplied to obtain the cumulative survival probability.</p>
<p>The “survival” probability <span class="math inline">\(S(t_{j})\)</span> at each time interval is multiplied to obtain the</p>
<p>time is plotted on the x-axis and the survival function is plotted on the y-axis.</p>
<p>The K-M plot of the estimated cumulative probability of surviving with 95% confidence interval (lower 95% CI, upper 95% CI) is depicted in <a href="#fig-p1" class="quarto-xref">Figure&nbsp;<span>32.2</span></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km.A</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html">ggsurvfit</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"#077E97"</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"winter_bright"</span>, base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_confidence_interval.html">add_confidence_interval</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#077E97"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_censor_mark.html">add_censor_mark</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"brown"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_risktable.html">add_risktable</a></span><span class="op">(</span>risktable_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n.risk"</span>, <span class="st">"cum.censor"</span>, <span class="st">"cum.event"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_quantile.html">add_quantile</a></span><span class="op">(</span>y_value <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0</span>, <span class="fl">0.02</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/scale_colour_prism.html">scale_colour_prism</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Kaplan-Meier curve for the new therapy A"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time in months"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Cumulative Survival Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.02</span>, color <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-p1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="survival_files/figure-html/fig-p1-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;32.2: sdfsfsf</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-p1" class="quarto-xref">Figure&nbsp;<span>32.2</span></a>, These intervals are typically represented on the x-axis of the chart.</p>
<p>The lengths of the horizontal lines along the X-axis of serial times represent the survival duration for that interval.</p>
<p>The K-M curve is stepped over time because the estimate changes only at times when an event has occurred. At time <span class="math inline">\(t_{0} = 0\)</span>, all patients are at risk and hence, the cumulative probability of surviving is <span class="math inline">\(S(t_{0}) = S(0) = 1\)</span>. Note that the survival curve is defined only up to 35 weeks, the largest of the observation times.</p>
<p>Censoring times are marked on the K-M plot as + symbols.</p>
<p>In figure 1, the vertical axis runs from 0 to 1 and the horizontal from 0 to 12 years post randomisation (though this was not the longest follow- up available). The Kaplan–Meier estimate for the control arm is depicted by a red-dashed line and for the research arm by a solid blue line. The ‘curves’ are stepped over time because the estimate changes only at times when an event has occurred. These steps become more pronounced over time as more participants are censored. Beneath the horizontal axis is a table that reports the number of participants still ‘at-risk’ at specific time points (here 0, 2, 4, 6, 8, 10 and 12 years), that is, they are still in follow-up at this time point, not having had an event or been censored. In figure 1, after 10 years, there remain 71 and 99 participants at risk of an event in the control and research arms, respectively.</p>
<p>If we want to find the <strong>median time</strong> of surviving for patients in the new therapy A, we have to call the <code>km.A</code> survival object:</p>
<div class="cell">
<div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km.A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Call: survfit(formula = Surv(time, status) ~ 1, data = dat.A)

      n events median 0.95LCL 0.95UCL
[1,] 21      9     23      16      NA</code></pre>
</div>
</div>
<p>We observe that the median time equals to 23 for this group of patients.</p>
</section></section><section id="comparing-survival-curves" class="level2" data-number="32.5"><h2 data-number="32.5" class="anchored" data-anchor-id="comparing-survival-curves">
<span class="header-section-number">32.5</span> Comparing survival curves</h2>
<div class="cell">
<div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">###KM curves and log-rank test for Transfusion group</span></span>
<span><span class="co">#plot by Transfusion group</span></span>
<span><span class="va">km.AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/survfit2.html">survfit2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">intervention</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co"># to find which month corresponds to median survival run:</span></span>
<span><span class="va">km.AB</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Call: survfit(formula = Surv(time, status) ~ intervention, data = dat)

                                   n events median 0.95LCL 0.95UCL
intervention=therapy A (new)      21      9     23      16      NA
intervention=therapy B (standard) 21     18      9       5      15</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#Run log-Rank test to compare the curves for the Transfusion groups</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">intervention</span>, data <span class="op">=</span> <span class="va">dat</span>, rho <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Call:
survdiff(formula = Surv(time, status) ~ intervention, data = dat, 
    rho = 0)

                                   N Observed Expected (O-E)^2/E (O-E)^2/V
intervention=therapy A (new)      21        9    17.65      4.24      13.3
intervention=therapy B (standard) 21       18     9.35      8.00      13.3

 Chisq= 13.3  on 1 degrees of freedom, p= 3e-04 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km.AB</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html">ggsurvfit</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"winter_bright"</span>, base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_confidence_interval.html">add_confidence_interval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_censor_mark.html">add_censor_mark</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"brown"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_risktable.html">add_risktable</a></span><span class="op">(</span>risktable_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n.risk"</span>, <span class="st">"cum.censor"</span>, <span class="st">"cum.event"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_quantile.html">add_quantile</a></span><span class="op">(</span>y_value <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0</span>, <span class="fl">0.02</span>, <span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0</span>, <span class="fl">0.05</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#077E97"</span>, <span class="st">"#800080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#077E97"</span>, <span class="st">"#800080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Kaplan-Meier curves (new therapy A vs standard therapy B)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Log-rank test {survfit2_p(km.AB)}"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time in months"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Cumulative Survival Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.02</span>, color <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.89</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="survival_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb22" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">km.AB</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/ggsurvfit.html">ggsurvfit</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"risk"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"winter_bright"</span>, base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_confidence_interval.html">add_confidence_interval</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_censor_mark.html">add_censor_mark</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"brown"</span>, size <span class="op">=</span> <span class="fl">3.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_risktable.html">add_risktable</a></span><span class="op">(</span>risktable_stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n.risk"</span>, <span class="st">"cum.censor"</span>, <span class="st">"cum.event"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="http://www.danieldsjoberg.com/ggsurvfit/reference/add_quantile.html">add_quantile</a></span><span class="op">(</span>y_value <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"gray50"</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0</span>, <span class="fl">0.02</span>, <span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span><span class="op">)</span>, </span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">35</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.018</span>, <span class="fl">0.02</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#077E97"</span>, <span class="st">"#800080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#077E97"</span>, <span class="st">"#800080"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Kaplan-Meier curves (new therapy A vs standard therapy B)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"Log-rank test {survfit2_p(km.AB)}"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Time in months"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Cumulative Survival Probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.02</span>, color <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.89</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="survival_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Here’s how the Kaplan-Meier chart works:</p>
<p>Data Collection: Data is collected for a group of subjects who are followed over a specific time period. For example, in a clinical trial, patients may be monitored for the occurrence of a particular event or outcome.</p>
<p>Time Intervals: The time period is divided into discrete intervals, such as days, months, or years. These intervals are typically represented on the x-axis of the chart.</p>
<p>Event Status: For each subject, their event status is noted at each time interval. The event status can be coded as 1 if the event of interest occurred (e.g., death) or 0 if the event did not occur (e.g., still alive).</p>
<p>We display the results and draw the Kaplan-Meier plot:</p>
<p>On the Kaplan–Meier curve of the small crosses correspond to censored data.</p>
<p>In our case, the time period is divided into discrete intervals, such as days, months, or years. These intervals are typically represented on the x-axis of the chart.</p>
<p>Cumulative Survival Probability: The survival probabilities at each time interval are multiplied to obtain the cumulative survival probability. This cumul</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      try { hash = new URL(url).hash; } catch {}
      const id = hash.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note !== null) {
        try {
          const html = processXRef(id, note);
          instance.setContent(html);
        } finally {
          instance.enable();
          instance.show();
        }
      } else {
        // See if we can fetch this
        fetch(url.split('#')[0])
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.getElementById(id);
          console.log(htmlDoc.body.innerHTML);
          if (note !== null) {
            const html = processXRef(id, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Handle positioning of the toggle
      window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./cochran.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cochran’s Q Test</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./measurement_properties.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Measurement properties</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2023, Konstantinos I. Bougioukas</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><div class="page-columns page-rows-contents page-layout-article"><div class="social-share">
<a href="https://twitter.com/share?url=https://practical-stats-med-r.netlify.app/&amp;text=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="twitter"><i class="fab fa-twitter fa-fw fa-lg"></i></a><a href="https://www.linkedin.com/shareArticle?url=https://practical-stats-med-r.netlify.app/&amp;title=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a><a href="https://www.facebook.com/sharer.php?u=https://practical-stats-med-r.netlify.app/" target="_blank" class="facebook"><i class="fab fa-facebook-f fa-fw fa-lg"></i></a>
</div></div>



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>