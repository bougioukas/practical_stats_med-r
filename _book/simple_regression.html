<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.322">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Practical Statistics in Medicine with R - 27&nbsp; Simple linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chi_square.html" rel="next">
<link href="./correlation.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/social-share.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/all.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.31/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script><script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">Part 2: Statistics</a></li><li class="breadcrumb-item"><a href="./simple_regression.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical Statistics in Medicine with R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part 1: R Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R via RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstudio_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with RStudio Projects and writing R scripts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R as calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures in R: 1-Dimensional Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data structures in R: matrices and arrays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data structures in R: lists and data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Basic concepts of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Foundations for statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Two-sample t-test (Student’s t-test)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wmw_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wilcoxon-Mann-Whitney (Mann-Whitney U) test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wilcoxon_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wilcoxon Signed-Rank test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">One-way ANOVA test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kruskal_wallis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Kruskal-Wallis test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Repeated Measures ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Friedman test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi_square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Chi-sqaure test of independence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fisher_exact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fisher’s exact test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mcnemar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">McNemar’s test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cochran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cochran’s Q Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Measures of relative and absolute reliability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diagnostic_accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Measures of diagnostic test accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Receiver Operating Characteristic (ROC) curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Sample size calculation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#the-mathematical-equation-of-a-straight-line" id="toc-the-mathematical-equation-of-a-straight-line" class="nav-link active" data-scroll-target="#the-mathematical-equation-of-a-straight-line"><span class="header-section-number">27.1</span> The mathematical equation of a straight line</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><span class="header-section-number">27.2</span> Research question</a></li>
  <li><a href="#packages-we-need" id="toc-packages-we-need" class="nav-link" data-scroll-target="#packages-we-need"><span class="header-section-number">27.3</span> Packages we need</a></li>
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data"><span class="header-section-number">27.4</span> Preparing the data</a></li>
  <li><a href="#basic-concepts" id="toc-basic-concepts" class="nav-link" data-scroll-target="#basic-concepts"><span class="header-section-number">27.5</span> Basic concepts</a></li>
  <li>
<a href="#ordinary-least-squares-ols-estimation-of-b_0-and-b_1-in-matrix-form" id="toc-ordinary-least-squares-ols-estimation-of-b_0-and-b_1-in-matrix-form" class="nav-link" data-scroll-target="#ordinary-least-squares-ols-estimation-of-b_0-and-b_1-in-matrix-form"><span class="header-section-number">27.6</span> Ordinary least squares (OLS) estimation of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in matrix form</a>
  <ul class="collapse">
<li><a href="#in-r" id="toc-in-r" class="nav-link" data-scroll-target="#in-r">In R:</a></li>
  </ul>
</li>
  <li>
<a href="#the-standard-error-se-of-the-coefficients" id="toc-the-standard-error-se-of-the-coefficients" class="nav-link" data-scroll-target="#the-standard-error-se-of-the-coefficients"><span class="header-section-number">27.7</span> The Standard error (SE) of the coefficients</a>
  <ul class="collapse">
<li><a href="#in-r-1" id="toc-in-r-1" class="nav-link" data-scroll-target="#in-r-1">In R:</a></li>
  </ul>
</li>
  <li>
<a href="#test-statistic-and-confidence-intervals" id="toc-test-statistic-and-confidence-intervals" class="nav-link" data-scroll-target="#test-statistic-and-confidence-intervals"><span class="header-section-number">27.8</span> Test statistic and confidence intervals</a>
  <ul class="collapse">
<li><a href="#in-r-2" id="toc-in-r-2" class="nav-link" data-scroll-target="#in-r-2">In R:</a></li>
  </ul>
</li>
  <li>
<a href="#lm-function" id="toc-lm-function" class="nav-link" data-scroll-target="#lm-function"><span class="header-section-number">27.9</span> lm() function</a>
  <ul class="collapse">
<li><a href="#classical-approach" id="toc-classical-approach" class="nav-link" data-scroll-target="#classical-approach">Classical approach</a></li>
  <li><a href="#tidy-approach-tidymodels" id="toc-tidy-approach-tidymodels" class="nav-link" data-scroll-target="#tidy-approach-tidymodels">Tidy approach (tidymodels)</a></li>
  <li><a href="#summary-table" id="toc-summary-table" class="nav-link" data-scroll-target="#summary-table">Summary table</a></li>
  </ul>
</li>
  <li>
<a href="#verifying-model-assumptions" id="toc-verifying-model-assumptions" class="nav-link" data-scroll-target="#verifying-model-assumptions"><span class="header-section-number">27.10</span> Verifying Model Assumptions</a>
  <ul class="collapse">
<li><a href="#linearity-of-the-data" id="toc-linearity-of-the-data" class="nav-link" data-scroll-target="#linearity-of-the-data">Linearity of the data</a></li>
  <li><a href="#independence-of-the-residuals" id="toc-independence-of-the-residuals" class="nav-link" data-scroll-target="#independence-of-the-residuals">Independence of the residuals</a></li>
  <li><a href="#normality-of-the-residuals" id="toc-normality-of-the-residuals" class="nav-link" data-scroll-target="#normality-of-the-residuals">Normality of the residuals</a></li>
  <li><a href="#equality-of-variance-of-the-residuals-homoscedasticity" id="toc-equality-of-variance-of-the-residuals-homoscedasticity" class="nav-link" data-scroll-target="#equality-of-variance-of-the-residuals-homoscedasticity">Equality of variance of the residuals (Homoscedasticity)</a></li>
  <li><a href="#influential-observations-in-the-data" id="toc-influential-observations-in-the-data" class="nav-link" data-scroll-target="#influential-observations-in-the-data">Influential observations in the data</a></li>
  </ul>
</li>
  <li>
<a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">27.11</span> Model evaluation</a>
  <ul class="collapse">
<li><a href="#residual-standard-error-rse" id="toc-residual-standard-error-rse" class="nav-link" data-scroll-target="#residual-standard-error-rse">Residual standard error (RSE)</a></li>
  <li><a href="#in-r-3" id="toc-in-r-3" class="nav-link" data-scroll-target="#in-r-3">In R:</a></li>
  <li><a href="#coefficient-of-determination-r2" id="toc-coefficient-of-determination-r2" class="nav-link" data-scroll-target="#coefficient-of-determination-r2">Coefficient of determination <span class="math inline">\(R^2\)</span></a></li>
  </ul>
</li>
  <li><a href="#present-the-results" id="toc-present-the-results" class="nav-link" data-scroll-target="#present-the-results"><span class="header-section-number">27.12</span> Present the results</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./introduction.html">Part 2: Statistics</a></li><li class="breadcrumb-item"><a href="./simple_regression.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-simple_regression" class="quarto-section-identifier"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this chapter, we explore an extension of correlation for investigating the association between two variables: the <strong>simple linear regression</strong>.</p>
<p>When we have finished this Chapter, we should be able to:</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:red;overflow:visible;position:relative;"><path d="M464 256A208 208 0 1 0 48 256a208 208 0 1 0 416 0zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256zm256-96a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"></path></svg> Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Fit and interpret simple linear models</li>
<li>Assess the quality of a linear regression fit</li>
</ul>
</div>
</div>
<section id="the-mathematical-equation-of-a-straight-line" class="level2" data-number="27.1"><h2 data-number="27.1" class="anchored" data-anchor-id="the-mathematical-equation-of-a-straight-line">
<span class="header-section-number">27.1</span> The mathematical equation of a straight line</h2>
<p>Simple linear regression involves a <strong>numeric dependent</strong> (or outcome) variable <span class="math inline">\(Y\)</span> and one independent (or explanatory) variable <span class="math inline">\(X\)</span> that is either numeric or categorical.</p>
<p>The general equation of a straight line is: <span id="eq-line1"><span class="math display">\[
y = \beta_0 + \beta_1 \cdot x
\tag{27.1}\]</span></span></p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create example data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>                   y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a linear regression line with annotations</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Linear Regression Plot"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, y <span class="op">=</span> <span class="fl">5.5</span>, label <span class="op">=</span> <span class="st">"Y Variable"</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">4.4</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">0.18</span>, label <span class="op">=</span> <span class="st">"X Variable"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"black"</span>, shape <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="op">-</span><span class="fl">0.6</span>, y <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    xend <span class="op">=</span> <span class="op">-</span><span class="fl">0.15</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    arrow <span class="op">=</span> <span class="fu">arrow</span><span class="op">(</span>length <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.12</span>, <span class="st">"inches"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span> </span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="op">-</span><span class="fl">0.8</span>, y <span class="op">=</span> <span class="fl">1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">β</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_segment</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>, </span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">2.5</span>, y <span class="op">=</span> <span class="fl">2.8</span>, label <span class="op">=</span> <span class="st">"1 unit"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">3.4</span>, y <span class="op">=</span> <span class="fl">3.5</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">β</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_fixed</span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-line-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption class="figure-caption">Figure&nbsp;27.1: Parameters of a straight line.</figcaption></figure>
</div>
</div>
</div>
<p>The <a href="#eq-line1" class="quarto-xref">Equation&nbsp;<span>27.1</span></a> is defined by two coefficients (parameters) <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<ul>
<li><p>The <strong>intercept coefficient</strong> <span class="math inline">\(\beta_0\)</span> is the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x = 0\)</span> (the black point where the dashed blue line crosses the y-axis; <a href="#fig-line" class="quarto-xref">Figure&nbsp;<span>27.1</span></a>).</p></li>
<li><p>The <strong>slope coefficient</strong> <span class="math inline">\(\beta_1\)</span> for <span class="math inline">\(x\)</span> is the change in <span class="math inline">\(y\)</span> for every one unit increase in <span class="math inline">\(x\)</span> (<a href="#fig-line" class="quarto-xref">Figure&nbsp;<span>27.1</span></a>).</p></li>
</ul>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Comment
</div>
</div>
<div class="callout-body-container callout-body">
<p>The term “dependent” does not necessarily imply a cause and effect association between the two variables.</p>
</div>
</div>
</section><section id="research-question" class="level2" data-number="27.2"><h2 data-number="27.2" class="anchored" data-anchor-id="research-question">
<span class="header-section-number">27.2</span> Research question</h2>
<p>Continuing from the previous chapter, we’re analyzing the data in the <em>BirthWeight</em> dataset exploring the association between weight and height of the infants. But now, our aim is to build a <strong>model</strong> where the dependent variable Y is a function of the explanatory variable X.</p>
</section><section id="packages-we-need" class="level2" data-number="27.3"><h2 data-number="27.3" class="anchored" data-anchor-id="packages-we-need">
<span class="header-section-number">27.3</span> Packages we need</h2>
<p>We need to load the following packages:</p>
<div class="cell">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># packages for graphs</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://csdaw.github.io/ggprism/">ggprism</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># packages for data description, transformation and analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/matlib">matlib</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/performance/">performance</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/see/">see</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># packages for reporting the results</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/report/">report</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="preparing-the-data" class="level2" data-number="27.4"><h2 data-number="27.4" class="anchored" data-anchor-id="preparing-the-data">
<span class="header-section-number">27.4</span> Preparing the data</h2>
<div class="cell">
<div class="sourceCode" id="cb3" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">BirthWeight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"BirthWeight.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div id="fig-BirthWeight" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><div class="datatables html-widget html-fill-item" id="htmlwidget-3f5abbae1c1e9bbb2055" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3f5abbae1c1e9bbb2055">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550"],[3950,4630,4750,3920,4560,3640,3550,4530,4970,3740,4190,4350,4620,4090,4420,5620,5250,4320,4410,4180,4290,4670,3970,4570,4530,4180,4780,3720,4530,4460,4110,4000,3420,4950,3300,4520,4070,4540,4050,3340,4770,4210,4260,3880,4360,4650,5400,3900,4240,3740,3700,4340,4610,4600,4890,3690,4470,5140,4770,4500,5340,3530,5020,5020,5450,5810,3660,3340,4200,4600,4840,3960,4260,3510,4620,5690,4520,3110,3790,4010,3540,4480,4920,4930,3900,4090,4590,4390,4990,4180,4120,3790,3990,4620,3480,4900,4260,4880,4060,4270,4680,4030,4100,4860,4700,3770,4010,4470,4780,4220,4730,4390,4600,4150,3740,3950,3880,5110,3050,3450,4520,3820,4400,3790,5020,5200,4740,3770,4270,4410,5550,4080,3590,5030,3850,4010,4910,5130,4980,4320,4270,5540,4350,4530,4920,3800,3890,3960,3850,3900,5180,4010,4450,5240,4320,5590,4290,3710,3360,3540,4520,3690,4510,3940,5000,3750,3980,4220,5500,4800,3890,4340,4320,3980,4560,5000,3620,4330,4670,5240,4590,4060,4610,4810,4740,4360,4070,4460,4460,4230,3960,4360,3840,4780,3720,5430,4490,4700,5310,4190,5180,4340,4070,4110,3500,4750,6330,5920,5410,4060,2920,4730,3730,3010,4180,4860,3700,3200,4000,4350,5450,3660,4560,4120,5080,3720,5050,4950,4390,4680,4320,3370,3550,5750,4890,4280,4860,3900,3950,4910,3130,5200,5230,4510,4340,3600,4980,4550,4270,4180,3680,3080,4900,4100,5410,5220,4450,4020,5480,4830,4300,4350,3760,4380,5180,5260,4630,4080,4230,3540,5820,5120,4030,5040,4080,5130,3960,5030,4060,4060,4040,3310,5430,3560,5270,4540,4050,5280,5330,3610,4640,4440,5280,4130,5260,3970,4700,3730,4410,4980,3690,4590,4490,4970,3990,4090,4200,3460,3180,4610,3670,4100,3280,4320,4700,4570,3580,4100,4600,4790,3780,4320,4330,4750,5190,4250,4050,4180,4040,4650,2980,4800,4300,4110,4760,3380,4050,4490,4700,4250,3720,3170,5060,3900,4130,3420,4010,4210,4630,5140,4870,4400,3990,4000,4800,4780,4440,3510,3370,3790,5020,3930,4580,3800,3930,4440,3810,3850,4500,3670,3840,3200,3370,5100,4890,4870,4610,4220,3670,4000,3900,3720,4680,3850,5300,4440,5320,4330,4750,4460,4140,4180,4150,5390,4140,4070,4770,4200,3850,4530,4410,4690,3510,3410,3680,3870,4830,5560,4470,3990,4700,3590,4060,4130,5170,3940,3330,4700,5120,4760,4810,4500,4790,5310,4200,3990,4900,3680,4270,3870,4740,3340,5290,4790,4630,5050,5100,4120,4700,3880,4040,4770,3310,4870,4550,3880,4610,4270,4790,4520,4230,5600,4010,3480,4650,4940,4220,4800,3790,4520,3910,3800,3680,4800,4750,4800,5050,3990,5160,4660,4620,3870,4520,4180,3860,4500,5080,4090,4110,4140,4130,3410,3810,4420,4070,3360,4030,4870,4750,4130,4920,4180,4730,5750,3790,4310,3680,4170,5210,3010,5250,4500,4840,3730,5550,4270,3950,4800,3590,3500,4760,3720,4500,4330,4510,4020,3700,4120,4440,5140,3090,5400,4520,4680,5760,4180,4020,3410,4670,4600,4230,3240,4210,4170,4950,4610,5330,3710,6490,5090,5430,4750,4900,3740,4320,5350,5390,3880,5230,4570],[55.5,57,56,56,55,51.5,56,57,58.5,52,54,59,56,53,57,58,58,54.5,57,53.5,55,54.5,53.5,59,56,56.5,58,52,55.5,58.5,53.5,54.5,51.5,56,52,55,53.5,59,54,50,56,54.5,54,52.5,52,55.5,58,52,57,51.5,52,57,56,56,57.5,54.5,53,62,56,58,58,51,56,56,58,56,51,55,52,55,56,57,53,51,56,59,52.5,51,52.5,55,52,57,56,56.5,53,54,56.5,55,59.5,52,54,51,50,57,54,57,54.5,57,54,53,56,52,53,55,56,53,54,56,56,53.5,54,51,56,48,51,51,52,58,52,51,52,55,55,55,54.5,59,56.5,51.5,55,58,60.5,53.7999992370605,52,58,53,53,54,56,57.5,57,55.7999992370605,58,56,56,56,57,54,54,57,54,57.5,54,56,59,56,59,56,52.5,51,53,53,53,53,58,57,54,53,55,59,56.5,52,55.5,55,52,53,58.5,52,59,54,57,54,55,56,57,55.5,55,54,57,54,54.5,53,53,54,58,52,57.5,56,55,60,53,56,56,55,52,56,56,59,56,57,56,49,55.5,53,53,59.5,56,54,52,53,54.5,58,52,54,50.5,57,52,57,56,52,53,59,50.5,51,60.5,56,54,60,54,52,59,50,56,53,54,54,53,58,54,49.5,53,52.5,50.5,59,54,61,54,52,54,55.5,56,55,54,53,55,57.5,60.5,56,55,53,51.5,62,61,51,57,56,57,53,57,53.5,58,53,51,61,53.5,58,53.5,57,58,56.5,55,57.5,56,54,53.5,58.5,52.5,57,53,55.5,57.5,53.5,54,51.5,57.5,52,54.5,54.5,52,55,57.5,53.5,50.5,50,55.5,55,58,55,52.5,56.5,56.5,53,52,53,58,53.5,53,53.5,53,53,56,51,54,54,54,55,51.5,53.5,53.5,57,52.5,53,49.5,57,51,52.5,53,54,53,56,60.5,56.5,52,53.5,54.5,55,56.5,53.5,53.5,51.5,54,56,53,56,54,54,55.5,53,54,54,51.5,54,51.5,55,59,55,55,55.5,55,56.5,55.5,55,55.5,53.5,55.5,53.5,53.5,60.5,56.5,55,56,53.5,56.5,55.5,58,54,54,55.5,56,55,56.5,56.5,58,50.5,50.5,53.5,52.5,58.5,59,57,55,57,52,54.5,55.5,60,54,53,54.5,55,56.5,57,53,56.5,58,55.5,54,57,54.5,54.5,54,60,54.5,56.5,56.5,55,56,57,52,56.5,53.5,53,54.5,51,57.5,54,51,55.5,54.5,54.5,55,53,57.5,55.5,53,55,54.5,54,56,52.5,56,54.5,58.5,51.5,53.5,56,58,55,54,58,55.5,53,54,55,54,52.5,53,56,54.5,53.5,52.5,55,51,52,54.5,51,53,54,56,55.5,52,54.5,53,54,58.5,53,56.5,53.5,52,56,51,57.5,54.5,57,52,57,55,55,57,53,50.5,55.5,52.5,51.5,55,54.5,55,50,58.5,55.5,57,51,54,55,52.5,55,54.5,52.5,51,55.5,54.5,56.5,54,54.5,56,58,57.5,58,53.5,62,55.9000015258789,58,57.5,54.5,54,55,57,60,52,57.5,53.5],[37.5,38.5,38.5,39,39.5,34.5,38,39.7,39,38,37.5,39.5,38.5,38,38,40,38.5,38.5,38,38,37.5,40.5,38,39.2,38,37.5,38.4,38,38.5,37.5,37.4,38.7,38,41.2,36,38.5,37,38.5,37,36,40.5,37.5,39,36,38,39.5,37.5,38.3,37.8,37,38,39,38,38,39,38,37.5,40.3,40.5,40.3,39,37.5,38.5,38.4,40.5,39.5,37.9,38,39,38,38,39.5,38,36.5,38.5,41,37.5,35.5,36,37,37.5,37.5,38.5,40,37.5,39.5,40,39,38,35.5,37.5,36,38,37,38,39,37,37,37,37.5,39,37,36,40,39,38,37.5,39,38,37,38,38,36.5,35,37,38,36,39,37,34.5,36,36,37.5,38.5,38.5,38,39.5,36,38,40.5,40.5,36.5,37.5,39,36.5,37.5,38,40,37.5,38,36.5,40,37.4,37.2,36.1,36.5,38,37.2,38,37,40.5,37.5,37,35,38.2,40,37.5,37,35,35.5,39,37,37.5,37,39,37,39,37,40.5,38,37,38,37.5,38.5,38,41,36.5,37,36.5,39.5,38,38,39,38,39,37.5,36.5,37,38.5,38,38,39.5,36.5,38.5,36.5,39.5,37,38.5,39,37,38,37,38,36.5,38.5,39,38.5,40,37.5,37,34,37.5,36,36.5,39,38.5,37.5,34.5,36,37.5,39.5,37.5,38.5,34.5,38,35.5,39,39.5,37,38,39,36,34.5,40,39,36,40.5,36,39,37.5,35.5,39,38,39.5,38,36.5,38,37,38,36.5,36.5,36,39.5,37,39.5,37,36.5,37.5,40,38,38.5,37.5,34.5,38.5,39,39,37,37.5,37.5,37,38.5,38.2,35.5,38.5,35.5,39.5,38,37.2,37.5,39,37.5,35,39.5,36.5,40,39,38,39,39.5,35,39,38.5,39.5,36,40,37,37.5,37,39,39,35.5,37,39,39.2,37.5,38,38,37,38.5,38,37,38,37,40,37,39.8,37,36,38,39,38,37.5,37,39,39,38,37,39,37.4,38,36,40,36.5,37,40.5,35.5,37.2,38,38,38.7,36,35.5,38,37.5,37.5,36,40,38.5,40.5,40.5,38.5,38.4,37.5,39,35,39,37.3,36.5,36,37.5,39.5,39.5,39,38,36.5,37.5,38,36,37.5,36.5,36.6,37,38,40.5,37,40,38,39.5,36.5,37.5,37,36.5,38.5,37,40,37.5,40.5,39.5,39,38.5,38,37.5,40,39.5,38,38,37,39,38,39,38,37,34.5,37,36.8,37.5,38.6,39.5,39.5,38.5,38,37.5,38,38,39,36,34.5,37,40,39,39,37.9,39,40.5,39,38.5,39.5,37.5,36.5,38.5,39,36.5,39,40,38,39,40,36,39.5,38,37.5,38.5,35.7,38,38,37,39,37.5,39,39,36.5,40.5,36.5,36.5,38.7,37.5,38,38,38,40,37.5,41,38,37,39,40,36.5,37,39.5,39,38,36.5,37,38,37.5,36,37.5,37.5,40,37.5,38.5,38.5,36.5,36,38.5,36.5,36.5,40,36.5,38,39,38,37,40.5,37,37.5,38,37,39,37,38,37.5,39,36.5,39.5,37,37,38,37,36,37.5,35,35.5,37,38,34.5,36,40.5,37.5,40,36,37.5,38,37.5,38.5,37,37,35.5,38.5,38.5,38.5,36.5,36.5,38,40,39,40,35,39,39,39,37.5,37.5,36,37.5,39.5,40,36,40,37.5],["Female","Female","Male","Male","Male","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Male","Male","Male","Female","Male","Male","Male","Male","Male","Female","Male","Female","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Male","Female","Male","Female","Male","Female","Female","Male","Male","Female","Male","Male","Female","Male","Female","Female","Male","Male","Female","Male","Male","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Male","Female","Female","Male","Female","Male","Male","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Female","Male","Female","Female","Male","Female","Female","Female","Female","Male","Female","Female","Female","Male","Male","Male","Female","Male","Male","Female","Male","Male","Male","Male","Male","Female","Female","Male","Male","Female","Male","Male","Female","Male","Male","Female","Male","Male","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Female","Male","Female","Female","Female","Female","Male","Male","Male","Male","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Male","Male","Female","Male","Female","Male","Male","Female","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Male","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Male","Male","Female","Male","Female","Female","Female","Male","Male","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Male","Female","Male","Female","Female","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Female","Male","Male","Female","Female","Female","Female","Female","Female","Female","Male","Male","Male","Male","Female","Male","Female","Male","Male","Female","Female","Male","Male","Male","Female","Female","Male","Male","Male","Male","Male","Female","Female","Female","Male","Male","Male","Female","Female","Male","Female","Male","Female","Female","Female","Male","Female","Male","Male","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Female","Male","Male","Female","Male","Male","Male","Female","Female","Female","Female","Female","Female","Male","Female","Male","Male","Female","Male","Male","Female","Male","Male","Female","Female","Male","Female","Female","Female","Male","Female","Female","Female","Female","Male","Female","Male","Male","Male","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Female","Male","Female","Male","Female","Female","Female","Female","Male","Female","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Male","Female","Female","Male","Male","Male","Female","Male","Female","Male","Male","Female","Male","Female","Female","Male","Female","Male","Male","Male","Female","Female","Male","Male","Female","Female","Male","Female","Male","Male","Male","Male","Female","Male","Male","Male","Female","Female","Male","Male","Male","Male","Female","Male","Male","Male","Male","Male","Male","Female","Male","Male","Male","Male","Female"],["tertiary","tertiary","year12","tertiary","year10","tertiary","year10","year10","tertiary","year10","year10","year10","year10","year12","year10","tertiary","year12","year10","tertiary","tertiary","year12","year10","year10","year12","tertiary","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year12","year12","year10","year10","tertiary","tertiary","tertiary","year10","year10","year10","year10","year10","year10","year12","year10","tertiary","year10","year10","year12","year12","tertiary","tertiary","year12","year10","tertiary","tertiary","tertiary","tertiary","year12","year12","year10","year10","year12","tertiary","year10","tertiary","year12","year10","tertiary","tertiary","year10","tertiary","year12","year10","year10","year10","year12","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","year10","year10","tertiary","year12","year10","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","year10","tertiary","tertiary","tertiary","tertiary","year10","year10","year10","year12","year10","year10","tertiary","year10","tertiary","year12","year12","year10","tertiary","year10","tertiary","year10","year12","year10","year10","tertiary","year10","tertiary","year10","year10","tertiary","year10","tertiary","year10","tertiary","year12","year10","year10","year12","year10","tertiary","tertiary","tertiary","tertiary","year12","tertiary","year12","tertiary","year10","year10","year10","tertiary","tertiary","year10","year10","year10","tertiary","year10","year10","year12","year12","year10","year10","tertiary","year12","tertiary","year12","year10","tertiary","tertiary","year10","tertiary","year10","tertiary","year10","year10","year12","year10","tertiary","tertiary","tertiary","year10","year10","year12","tertiary","year10","year10","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","year10","year10","tertiary","year12","tertiary","year10","year10","tertiary","year10","tertiary","year12","year10","year10","year10","tertiary","year10","tertiary","year12","tertiary","year10","year10","tertiary","year10","year12","tertiary","year10","year10","year12","year10","year12","year12","year12","tertiary","tertiary","year10","year10","year10","year10","year10","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","year10","tertiary","year10","year12","year10","tertiary","year10","year10","year10","tertiary","year10","year10","tertiary","year12","year12","tertiary","tertiary","year10","year12","year12","year10","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","tertiary","year12","year12","year12","year12","year10","year12","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year12","tertiary","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year12","year10","year10","tertiary","year12","tertiary","tertiary","tertiary","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","year12","tertiary","year10","year12","tertiary","tertiary","year12","tertiary","tertiary","year10","year12","tertiary","year12","year10","tertiary","year10","year10","tertiary","tertiary","year12","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year12","year10","year10","year10","tertiary","year12","year10","year10","year10","tertiary","tertiary","tertiary","tertiary","year12","year10","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","tertiary","year12","tertiary","tertiary","year12","tertiary","tertiary","tertiary","year10","year10","tertiary","year12","year10","tertiary","tertiary","year12","tertiary","year10","year10","tertiary","tertiary","year12","year10","tertiary","year10","tertiary","tertiary","year10","tertiary","tertiary","year12","year12","year10","year12","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","tertiary","year10","year10","year12","year12","year12","tertiary","year12","year12","tertiary","year10","tertiary","year10","year10","year10","tertiary","year10","tertiary","tertiary","year10","year12","year10","year12","year12","year10","year10","tertiary","tertiary","year10","year12","tertiary","year10","tertiary","year10","year12","year10","year10","tertiary","tertiary","year10","year12","year10","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year10","tertiary","year12","year10","tertiary","year12","year10","tertiary","tertiary","tertiary","year12","year10","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","tertiary","year10","tertiary","year10","tertiary","year10","year10","year10","year10","tertiary","tertiary","tertiary","year12","year12","tertiary","tertiary","year10","year10","tertiary","tertiary","year10","year10","year10","tertiary","year10","tertiary","year10","tertiary","year10","year12","year10","year10","year10","year10","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","tertiary","year10","tertiary","year12","year10","year10","year12","year12","year10","tertiary","year12","tertiary","year10","tertiary","tertiary","year10","year10","tertiary"],["2 or more siblings","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","Singleton","2 or more siblings","One sibling","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","Singleton","One sibling","Singleton","Singleton","Singleton","Singleton","Singleton","Singleton","One sibling","Singleton","Singleton","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","Singleton","Singleton","One sibling","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","Singleton","Singleton","Singleton","Singleton","Singleton","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","One sibling","Singleton","One sibling","One sibling","Singleton","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","Singleton","One sibling","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","2 or more siblings","One sibling","Singleton","Singleton","Singleton","Singleton","One sibling","Singleton","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","One sibling","Singleton","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","2 or more siblings","One sibling","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","One sibling","One sibling","Singleton","Singleton","One sibling","Singleton","2 or more siblings","Singleton","Singleton","Singleton","One sibling","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","One sibling","One sibling","One sibling","One sibling","Singleton","Singleton","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","Singleton","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","2 or more siblings","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","One sibling","One sibling","One sibling","One sibling","Singleton","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","Singleton","2 or more siblings","Singleton","One sibling","One sibling","Singleton","2 or more siblings","One sibling","Singleton","One sibling","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","One sibling","Singleton","Singleton","Singleton","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","One sibling","Singleton","2 or more siblings","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","Singleton","2 or more siblings","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","One sibling","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","Singleton","One sibling","One sibling","2 or more siblings","One sibling","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","Singleton","One sibling","Singleton","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","Singleton","2 or more siblings","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","Singleton","One sibling","2 or more siblings","One sibling","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","Singleton","2 or more siblings","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","Singleton","Singleton","Singleton","Singleton","One sibling","One sibling","One sibling","Singleton","One sibling","One sibling","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","Singleton","2 or more siblings","2 or more siblings","One sibling","One sibling","One sibling","Singleton","2 or more siblings","One sibling","2 or more siblings","One sibling","One sibling","One sibling","2 or more siblings","Singleton","Singleton","One sibling","One sibling","One sibling","2 or more siblings","2 or more siblings","One sibling","One sibling","2 or more siblings","2 or more siblings","2 or more siblings","2 or more siblings","One sibling","Singleton","Singleton","Singleton","2 or more siblings","2 or more siblings","Singleton","One sibling","2 or more siblings","2 or more siblings"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>weight<\/th>\n      <th>height<\/th>\n      <th>headc<\/th>\n      <th>gender<\/th>\n      <th>education<\/th>\n      <th>parity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"weight","targets":1},{"name":"height","targets":2},{"name":"headc","targets":3},{"name":"gender","targets":4},{"name":"education","targets":5},{"name":"parity","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><figcaption class="figure-caption">Figure&nbsp;27.2: Table with data from “BirthWeight” file.</figcaption></figure>
</div>
</div>
<p>We inspect the data and the type of variables:</p>
<div class="cell">
<div class="sourceCode" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Rows: 550
Columns: 6
$ weight    &lt;dbl&gt; 3950, 4630, 4750, 3920, 4560, 3640, 3550, 4530, 4970, 3740, …
$ height    &lt;dbl&gt; 55.5, 57.0, 56.0, 56.0, 55.0, 51.5, 56.0, 57.0, 58.5, 52.0, …
$ headc     &lt;dbl&gt; 37.5, 38.5, 38.5, 39.0, 39.5, 34.5, 38.0, 39.7, 39.0, 38.0, …
$ gender    &lt;chr&gt; "Female", "Female", "Male", "Male", "Male", "Female", "Femal…
$ education &lt;chr&gt; "tertiary", "tertiary", "year12", "tertiary", "year10", "ter…
$ parity    &lt;chr&gt; "2 or more siblings", "Singleton", "2 or more siblings", "On…</code></pre>
</div>
</div>
<p>We are interested in the numeric variables of <code>weight</code> (in g) and <code>height</code>(in cm).</p>
</section><section id="basic-concepts" class="level2" data-number="27.5"><h2 data-number="27.5" class="anchored" data-anchor-id="basic-concepts">
<span class="header-section-number">27.5</span> Basic concepts</h2>
<p>First, we plot the data in a scatter plot:</p>
<div class="cell">
<div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BirthWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_line_size <span class="op">=</span> <span class="fl">0.4</span>, palette <span class="op">=</span> <span class="st">"office"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x = Height (cm)"</span>, y <span class="op">=</span> <span class="st">"y = Weight (g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-scat-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption class="figure-caption">Figure&nbsp;27.3: Scatter plot of height and weight of 550 infants of 1 month age.</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-scat" class="quarto-xref">Figure&nbsp;<span>27.3</span></a>, the points are scattered around an invisible line. The objective is to find a mathematical approach that yields a line that, on average, goes through most of the points on the graph. This line is commonly known as a regression line or a line of best fit (blue line in <a href="#fig-linear_model" class="quarto-xref">Figure&nbsp;<span>27.4</span></a>). We write the equation of the best-fitting line as:</p>
<p><span id="eq-reg1"><span class="math display">\[\widehat{y} = b_0  + b_1 \cdot x \tag{27.2}\]</span></span></p>
<p>where <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are best choices or estimates of the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in <a href="#eq-line1" class="quarto-xref">Equation&nbsp;<span>27.1</span></a>, and <span class="math inline">\(\hat y\)</span> is the value of Y that is <strong>expected</strong> by this model for a specified value of X. We can interpret the “hat” notation as the dependent variable Y having a distribution (orange curve) with mean equals to <span class="math inline">\(\widehat{y}\)</span> for any given value of variable X (<a href="#fig-linear_model" class="quarto-xref">Figure&nbsp;<span>27.4</span></a>).</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">BirthWeight</span><span class="op">$</span><span class="va">height</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">BirthWeight</span><span class="op">$</span><span class="va">weight</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># breaks: where you want to compute densities</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">section</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span>, <span class="va">breaks</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the residuals</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute densities for each section, and flip the axes, and add means of sections</span></span>
<span><span class="co"># Note: the densities need to be scaled in relation to the section size (2000 here)</span></span>
<span><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">dat</span><span class="op">$</span><span class="va">section</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">res</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">-</span> <span class="va">d</span><span class="op">$</span><span class="va">y</span><span class="op">*</span><span class="fl">2000</span>, y <span class="op">=</span> <span class="va">d</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="co">## Get some data for normal lines as well</span></span>
<span>  <span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">res</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">res</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">xs</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,</span>
<span>                               x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2000</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">xs</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">res</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">res</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"empirical"</span>, <span class="st">"normal"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dens</span><span class="op">$</span><span class="va">section</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">section</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dens</span><span class="op">[</span><span class="va">dens</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"normal"</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, group <span class="op">=</span> <span class="va">section</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"salmon"</span>, lwd <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_line_size <span class="op">=</span> <span class="fl">0.4</span>, palette <span class="op">=</span> <span class="st">"office"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">breaks</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">breaks</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">60.2</span>, y <span class="op">=</span> <span class="fl">5100</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">widehat</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">==</span> <span class="va">b</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span> <span class="op">+</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, angle <span class="op">=</span> <span class="fl">25.7</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x = Height (cm)"</span>, y <span class="op">=</span> <span class="st">"y = Weight (g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-linear_model" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-linear_model-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;27.4: The Y variable having a distribution (orange curve) for any given value of variable X .</figcaption></figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>We define the following three concepts:</p>
<div class="content-box-yellow">

<ol type="1">
<li><p><strong>Observed</strong> value <span class="math inline">\(y_i\)</span>: the observed value of the dependent variable Y for a given <span class="math inline">\(x_i\)</span> value.</p></li>
<li><p><strong>Expected</strong> (or fitted) value <span class="math inline">\(\widehat{y_i}\)</span>: the value of the dependent variable Y that is expected by the model for a given <span class="math inline">\(x_i\)</span> value.</p></li>
<li>
<p><strong>Residual</strong> <span class="math inline">\(e_i\)</span>: the deviation (error) between the observed value <span class="math inline">\(y_i\)</span> and the expected value <span class="math inline">\(\hat y\)</span> for a given <span class="math inline">\(x_i\)</span> value (<span class="math inline">\(e_i = y_i - \hat y_i\)</span>).</p>
</li>
</ol>
</div>

<p>Let’s see, for example, the values for the infant in the position 207 in our data set (<a href="#fig-concepts" class="quarto-xref">Figure&nbsp;<span>27.5</span></a>).</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb8" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BirthWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">height</span>, <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, fill <span class="op">=</span> <span class="cn">NA</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"point"</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">5108</span>, col <span class="op">=</span> <span class="st">"#EC7014"</span>, shape <span class="op">=</span> <span class="fl">18</span>, size <span class="op">=</span> <span class="fl">7.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">59</span>, yend <span class="op">=</span> <span class="fl">6330</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span>, </span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">5108</span>,</span>
<span>    xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, yend <span class="op">=</span> <span class="fl">5108</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span>, </span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">6330</span>,</span>
<span>    xend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, yend <span class="op">=</span> <span class="fl">6330</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span>, </span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">52</span>, y <span class="op">=</span> <span class="fl">5108</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">52</span>, yend <span class="op">=</span> <span class="fl">6330</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="st">"npc"</span><span class="op">)</span>, ends <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"purple"</span>, ends <span class="op">=</span> <span class="st">"both"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">2910</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">207</span><span class="op">]</span> <span class="op">==</span> <span class="fl">59</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">4920</span>, label <span class="op">=</span> <span class="st">"expected value"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">6425</span>, label <span class="op">=</span> <span class="st">"observed data point"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">49.2</span>, y <span class="op">=</span> <span class="fl">5230</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu">widehat</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">207</span><span class="op">]</span> <span class="op">==</span> <span class="fl">5108</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">49.2</span>, y <span class="op">=</span> <span class="fl">6425</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="fl">207</span><span class="op">]</span> <span class="op">==</span> <span class="fl">6330</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">53.4</span>, y <span class="op">=</span> <span class="fl">5730</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="va">e</span><span class="op">[</span><span class="fl">207</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1222</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"purple"</span>, size <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">51.5</span>, y <span class="op">=</span> <span class="fl">5730</span>, label <span class="op">=</span> <span class="st">"residual"</span>, color <span class="op">=</span> <span class="st">"purple"</span>, size <span class="op">=</span> <span class="fl">5.5</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_line_size <span class="op">=</span> <span class="fl">0.4</span>, palette <span class="op">=</span> <span class="st">"office"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">47.9</span>, <span class="fl">63.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"X = Height (cm)"</span>, y <span class="op">=</span> <span class="st">"Y = Weight (g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-concepts" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-concepts-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption class="figure-caption">Figure&nbsp;27.5: Explanation of the basic concepts of the linear model.</figcaption></figure>
</div>
</div>
</div>
<ul>
<li><p>The <strong>observed value</strong> <span class="math inline">\(y\)</span> = 6330 g is infant’s weight for <span class="math inline">\(x\)</span> = 59 cm.</p></li>
<li><p>The <strong>expected value</strong> <span class="math inline">\(\widehat{y}\)</span> is the value 5108 g on the regression line for <span class="math inline">\(x\)</span> = 59. This value can be computed by the <a href="#eq-line3" class="quarto-xref">Equation&nbsp;<span>27.7</span></a>.</p></li>
<li><p>The <strong>residual</strong> is computed by subtracting the expected (fitted) value <span class="math inline">\(\widehat{y}\)</span> from the observed value <span class="math inline">\(y\)</span>. In the case, it is <span class="math inline">\(y - \widehat{y}\)</span> = 6330 - 5108 = 1222 g.</p></li>
</ul>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Comment
</div>
</div>
<div class="callout-body-container callout-body">
<p>The residuals are exactly the <strong>vertical</strong> distance between the observed data point and the associated point on the regression line (expected value) (<a href="#fig-concepts" class="quarto-xref">Figure&nbsp;<span>27.5</span></a>). Positive residuals are associated with y values above the fitted line, while negative residuals correspond to values below the line.</p>
<p>Residuals can be thought of as “noise” - they are fluctuations caused by various factors, preventing the observed values from forming a perfectly straight line on the scatter plot. Residuals play a crucial role in linear regression as they provide valuable insights into the <strong>assessment</strong> of a linear regression model.</p>
</div>
</div>
</section><section id="ordinary-least-squares-ols-estimation-of-b_0-and-b_1-in-matrix-form" class="level2" data-number="27.6"><h2 data-number="27.6" class="anchored" data-anchor-id="ordinary-least-squares-ols-estimation-of-b_0-and-b_1-in-matrix-form">
<span class="header-section-number">27.6</span> Ordinary least squares (OLS) estimation of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> in matrix form</h2>
<p>Let’s describe for the <span class="math inline">\(i^{th}\)</span> observation the underlying association between <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> by:</p>
<p><span id="eq-line1.5"><span class="math display">\[y_i = b_0  + b_1 \cdot x_i + e_i \tag{27.3}\]</span></span></p>
<p>where the <span class="math inline">\(e_i\)</span> is the error term, called <strong>residual</strong>, which represents the deviation between the observed value <span class="math inline">\(y_i\)</span> and the expected value <span class="math inline">\(\hat y\)</span> of the linear model (<span class="math inline">\(e_i = y_i - \hat y_i\)</span>).</p>
<p>In a matrix notation, given <span class="math inline">\(n\)</span> observations of the explanatory variable <strong>x</strong> and the outcome variable <strong>y</strong>, the <a href="#eq-line1.5" class="quarto-xref">Equation&nbsp;<span>27.3</span></a> becomes:</p>
<p><span id="eq-mtrx2"><span class="math display">\[\begin{bmatrix} y_1\\ y_2 \\ y_3 \\ ... \\ y_n \end{bmatrix} = \begin{bmatrix} 1 &amp; x_1\\ 1 &amp; x_2\\ 1 &amp; x_3\\ ... \\ 1 &amp; x_n
\end{bmatrix} \bullet \begin{bmatrix} b_0\\ b_1\end{bmatrix} + \begin{bmatrix} e_1\\ e_2 \\ e_3 \\ ... \\ e_n \end{bmatrix} \tag{27.4}\]</span></span></p>
<p>Then the outcome <strong>y</strong> can be compactly modeled by:</p>
<p><span id="eq-mtrx1"><span class="math display">\[Y = X\hat{B} + e \tag{27.5}\]</span></span></p>
<p>where the matrix <strong>X</strong> is called the <strong>design matrix</strong> (the first column contains 1s, and the second column contains the actual observations of x).</p>
<p>The coefficients <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are selected by <strong>minimizing</strong> the sum of squares of the residuals <span class="math inline">\(e\)</span>. It can be proven that the least squares estimates are obtained by the following matrix formula:</p>
<p><span id="eq-mtrx3"><span class="math display">\[\hat{B} = (X^TX)^{-1}X^TY = \begin{bmatrix} b_0 \\ b_1 \end{bmatrix} \tag{27.6}\]</span></span></p>
<p>That is, we’ve got one matrix equation which gives us both coefficient estimates.</p>
<section id="in-r" class="level3"><h3 class="anchored" data-anchor-id="in-r">In R:</h3>
<div class="cell">
<div class="sourceCode" id="cb9" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">BirthWeight</span><span class="op">$</span><span class="va">weight</span>, <span class="va">n</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ones</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">ones</span>, height <span class="op">=</span> <span class="va">BirthWeight</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span><span class="va">B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                [,1]
intercept -5412.1448
height      178.3078</code></pre>
</div>
</div>
<p>The regression equation for our example becomes:</p>
<p><span id="eq-line3"><span class="math display">\[
\begin{aligned}
\widehat{y} &amp;= b_0 + b_1 \cdot x\\
\widehat{\text{weight}} &amp;= b_0 + b_1 \cdot\text{height}\\
\widehat{\text{weight}}&amp;= -5412.14 + 178.31 \cdot\text{height}
\end{aligned}
\tag{27.7}\]</span></span></p>
<p>The intercept <span class="math inline">\(b_0\)</span> = -5412.14 is the mean weight for those infants with height of 0. Visually, it’s the point where the line crosses the y-axis when x equals 0 (<a href="#fig-intercept" class="quarto-xref">Figure&nbsp;<span>27.6</span></a>).</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb11" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a linear regression line with annotations</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BirthWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span>, y <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span>, fullrange <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">62</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6000</span>, <span class="fl">6500</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">19.0</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html">bquote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span> <span class="op">(</span><span class="fu">widehat</span><span class="op">(</span><span class="va">weight</span><span class="op">)</span>, <span class="st">"= -5412.14 + 178.31*height"</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, angle <span class="op">=</span> <span class="fl">32</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_line_size <span class="op">=</span> <span class="fl">0.4</span>, palette <span class="op">=</span> <span class="st">"office"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x = Height (cm)"</span>, y <span class="op">=</span> <span class="st">"y = Weight (g)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-intercept" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-intercept-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption class="figure-caption">Figure&nbsp;27.6: Scatter plot with fitted line crossing the y-axis.</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Comment
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that while there is a mathematical interpretation for the intercept of the regression line, it doesn’t hold any physical meaning in this case, as the observation of a weight of 0 is not feasible.</p>
</div>
</div>
<p>Of greater importance is the slope of the fitted line, <span class="math inline">\(b_1 = 178.31\)</span>, as this describes the association between the <code>height</code> and <code>weight</code> variables.</p>
<div class="cell">
<details><summary>Show the code</summary><div class="sourceCode" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a linear regression line with annotations</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">BirthWeight</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span>, y <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, color <span class="op">=</span> <span class="st">"blue"</span>, fullrange <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://csdaw.github.io/ggprism/reference/theme_prism.html">theme_prism</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span>, base_line_size <span class="op">=</span> <span class="fl">0.4</span>, palette <span class="op">=</span> <span class="st">"office"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x = Height (cm)"</span>, y <span class="op">=</span> <span class="st">"y = Weight (g)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">56</span>, y <span class="op">=</span> <span class="fl">4560</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">60</span>, yend <span class="op">=</span> <span class="fl">4560</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fl">60</span>, y <span class="op">=</span> <span class="fl">4560</span>,</span>
<span>    xend <span class="op">=</span> <span class="fl">60</span>, yend <span class="op">=</span> <span class="fl">5270</span>,</span>
<span>    lineend <span class="op">=</span> <span class="st">"round"</span>, </span>
<span>    linejoin <span class="op">=</span> <span class="st">"round"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.2</span>, </span>
<span>    colour <span class="op">=</span> <span class="st">"#EC7014"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">55.6</span>, y <span class="op">=</span> <span class="fl">4800</span>, label <span class="op">=</span> <span class="st">"(56, 4560)"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">59</span>, y <span class="op">=</span> <span class="fl">5400</span>, label <span class="op">=</span> <span class="st">"(60, 5270)"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">58</span>, y <span class="op">=</span> <span class="fl">4420</span>, label <span class="op">=</span> <span class="st">"dx"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">60.5</span>, y <span class="op">=</span> <span class="fl">4900</span>, label <span class="op">=</span> <span class="st">"dy"</span>, color <span class="op">=</span> <span class="st">"#EC7014"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-slope" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="simple_regression_files/figure-html/fig-slope-1.png" class="img-fluid figure-img" width="864"></p>
<figcaption class="figure-caption">Figure&nbsp;27.7: Graphical calculation of the slope in simple linear regression.</figcaption></figure>
</div>
</div>
</div>
<p>The graphical calculation of the slope from two points of the fitted blue line is (<a href="diagnostic_accuracy.html#fig-slope" class="quarto-xref">Figure&nbsp;<span>34.3</span></a>):</p>
<p><span class="math display">\[  
b_1 =\frac{dy}{dx}=\frac{5270-4560}{60-56}= \frac{710}{4} \approx 178 \ g/cm
\]</span></p>
<p>The positive slope indicates a positive association between height and weight. This implies that infants with greater height also generally exhibit increased weight.</p>
<div class="content-box-blue">
<p>For every 1 cm increase in height, there is <strong>on average</strong> an associated increase of 178 g in weight.</p>
</div>
</section></section><section id="the-standard-error-se-of-the-coefficients" class="level2" data-number="27.7"><h2 data-number="27.7" class="anchored" data-anchor-id="the-standard-error-se-of-the-coefficients">
<span class="header-section-number">27.7</span> The Standard error (SE) of the coefficients</h2>
<p>The standard error is a way to measure the “uncertainty” in the estimate of the regression coefficients and it can be calculated by:</p>
<p><span id="eq-se"><span class="math display">\[
\mathrm{SE}_{b_j} = \sqrt{\mathrm{Var}(b_j)}
\tag{27.8}\]</span></span></p>
<p>where the <span class="math inline">\(\mathrm{Var}(b_j)\)</span> represents the variance of the coefficients of the model.</p>
<p>We can obtain the <span class="math inline">\(\mathrm{Var}(b_j)\)</span> from the variance–covariance matrix. For the simple linear regression model is:</p>
<p><span id="eq-cov"><span class="math display">\[
\boldsymbol{\sigma^2_B} = \begin{bmatrix}\mathrm{Var}(b_0) &amp; \mathrm{Cov}(b_0,b_1) \\ \mathrm{Cov}(b_0,b_1)  &amp; \mathrm{Var}(b_1) \end{bmatrix}
\tag{27.9}\]</span></span></p>
<p>where <span class="math inline">\(\mathrm{Cov}(b_0,b_1)\)</span> represents the covariance of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>.</p>
<p>The variance-covariance matrix is a square, symmetric matrix which is defined in matrix notation as:</p>
<p><span id="eq-cov2"><span class="math display">\[
\boldsymbol{\sigma^2_B} = \sigma^2_{e} (\mathbf{X}^{\intercal}\mathbf{X})^{-1}
\tag{27.10}\]</span></span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Residual variance <span class="math inline">\(\sigma^2_{e}\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>In order to compute the variance-covariance matrix in <a href="#eq-cov2" class="quarto-xref">Equation&nbsp;<span>27.10</span></a>, we need to calculate the residual variance (i.e., mean squared residuals) for the model:</p>
<p><span id="eq-stderror"><span class="math display">\[
\sigma^2_{e} = \frac{SS_{residuals}}{df_{residuals}}
\tag{27.11}\]</span></span></p>
<p>where</p>
<ul>
<li><p>the residual sum of squares (also known as sum of squares error) is <span class="math inline">\(SS_{residuals} = \mathbf{e}^2 =\mathbf{e}^\intercal\mathbf{e}\)</span></p></li>
<li><p>the degrees of freedom are <span class="math inline">\(df_{residuals} = n -k\)</span>, where <span class="math inline">\(k\)</span> is the number of coefficients (including the intercept) being estimated in the regression model. Defining, the hat matrix, or the H-matrix, as: <span id="eq-Hat"><span class="math display">\[
\mathbf{H} = \mathbf{X}(\mathbf{X}^{\intercal}\mathbf{X})^{-1}\mathbf{X}^{\intercal}
\tag{27.12}\]</span></span> the <span class="math inline">\(k\)</span> equals to the trace of the H-matrix.</p></li>
</ul>
<p>Therefore, the <a href="#eq-stderror" class="quarto-xref">Equation&nbsp;<span>27.11</span></a> becomes: <span id="eq-stderror2"><span class="math display">\[
\sigma^2_{e} = \frac{\mathbf{e}^\intercal\mathbf{e}}{n - \mathrm{tr}(\mathbf{H})}
\tag{27.13}\]</span></span></p>
</div>
</div>
<section id="in-r-1" class="level3"><h3 class="anchored" data-anchor-id="in-r-1">In R:</h3>
<div class="cell">
<div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># calculate the residuals</span></span>
<span><span class="va">e</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span></span>
<span></span>
<span><span class="co"># compute the residual sum of squares (sum of squares error)</span></span>
<span><span class="va">ss_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">e</span></span>
<span></span>
<span><span class="co"># compute the H-matrix</span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute the residual variance</span></span>
<span><span class="va">var_e</span> <span class="op">&lt;-</span> <span class="va">ss_e</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/matlib/man/tr.html">tr</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># find the variance-covariance matrix of the coefficients</span></span>
<span><span class="va">var_covar_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">var_e</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span><span class="op">)</span></span>
<span><span class="va">var_covar_matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>           intercept      height
intercept 168954.042 -3074.89090
height     -3074.891    56.06929</code></pre>
</div>
</div>
<p>Finally, we can compute the standard error (SE) of the coefficients:</p>
<div class="cell">
<div class="sourceCode" id="cb15" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute the SEs</span></span>
<span><span class="va">std_error_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">var_covar_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">std_error_B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code> intercept     height 
411.040196   7.487943 </code></pre>
</div>
</div>
</section></section><section id="test-statistic-and-confidence-intervals" class="level2" data-number="27.8"><h2 data-number="27.8" class="anchored" data-anchor-id="test-statistic-and-confidence-intervals">
<span class="header-section-number">27.8</span> Test statistic and confidence intervals</h2>
<p>The hypothesis testing for the coefficients of the regression model are:</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \beta_j = 0\\
\text{vs } H_1&amp;: \beta_j \neq 0.
\end{aligned}
\]</span></p>
<p>The null hypothesis, <span class="math inline">\(H_{0}\)</span>, states that the coefficients are equal to zero, and the alternative hypothesis, <span class="math inline">\(H_{1}\)</span>, states that the coefficients are not equal to zero.</p>
<p>The <strong>t-statistic</strong> for the coefficients are defined by the following equation:</p>
<p><span id="eq-tstats"><span class="math display">\[
\ t_j = \frac{\ b_j}{\text{SE}_{b_j}}
\tag{27.14}\]</span></span></p>
<section id="in-r-2" class="level3"><h3 class="anchored" data-anchor-id="in-r-2">In R:</h3>
<div class="cell">
<div class="sourceCode" id="cb17" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute t for the coefficients bo and b1</span></span>
<span><span class="va">t_stat</span> <span class="op">=</span> <span class="va">B</span> <span class="op">/</span> <span class="va">std_error_B</span></span>
<span><span class="va">t_stat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>               [,1]
intercept -13.16695
height     23.81266</code></pre>
</div>
</div>
<p>We can use the p-value to guide our decision:</p>
<ul>
<li>If p − value &lt; 0.05, reject the null hypothesis, <span class="math inline">\(H_{0}\)</span>.</li>
<li>If p − value ≥ 0.05, do not reject the null hypothesis, <span class="math inline">\(H_{0}\)</span>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb19" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compute p-value for a two-tailed test</span></span>
<span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">t_stat</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">n</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/matlib/man/tr.html">tr</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                  [,1]
intercept 1.349861e-34
height    1.401002e-86</code></pre>
</div>
</div>
<p>In our example p &lt;0.001 <span class="math inline">\(\Rightarrow\)</span> reject <span class="math inline">\(H_{0}\)</span>.</p>
<p>The <span class="math inline">\(95\%\)</span> CI of the coefficients for a significance level α, <span class="math inline">\(df=n-k\)</span> degrees of freedom and for a two-tailed t-test is given by:</p>
<p><span id="eq-tci"><span class="math display">\[
95\% \ \text{CI}_{b_j} = b_j \pm t^{*}_{df;a/2} \cdot \text{SE}_{b_j}
\tag{27.15}\]</span></span></p>
<p>In our example:</p>
<div class="cell">
<div class="sourceCode" id="cb21" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># obtain critical value for 95% CI</span></span>
<span><span class="va">t_star</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.025</span>, df <span class="op">=</span> <span class="va">n</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/matlib/man/tr.html">tr</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># compute lower limit of 95% CI</span></span>
<span><span class="va">B</span> <span class="op">-</span> <span class="va">t_star</span><span class="op">*</span><span class="va">std_error_B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                [,1]
intercept -6219.5520
height      163.5992</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb23" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute upper limit of 95% CI</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">+</span> <span class="va">t_star</span><span class="op">*</span><span class="va">std_error_B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>                [,1]
intercept -4604.7375
height      193.0164</code></pre>
</div>
</div>
</section></section><section id="lm-function" class="level2" data-number="27.9"><h2 data-number="27.9" class="anchored" data-anchor-id="lm-function">
<span class="header-section-number">27.9</span> lm() function</h2>
<p>As anticipated, R provides a built-in function for the purpose of fitting linear regression models. We can utilize the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function to perform this task.</p>
<section id="classical-approach" class="level3"><h3 class="anchored" data-anchor-id="classical-approach">Classical approach</h3>
<div class="cell">
<div class="sourceCode" id="cb25" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">height</span>, data <span class="op">=</span> <span class="va">BirthWeight</span><span class="op">)</span></span>
<span><span class="va">model_lm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = weight ~ height, data = BirthWeight)

Coefficients:
(Intercept)       height  
    -5412.1        178.3  </code></pre>
</div>
</div>
<div id="exercise-joins" class="callout callout-style-default callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#0008C1;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg> Summary information about the model
</div>
</div>
<div class="callout-body-container callout-body">
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">base</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">parameters</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb27" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
Call:
lm(formula = weight ~ height, data = BirthWeight)

Residuals:
     Min       1Q   Median       3Q      Max 
-1218.86  -263.13   -24.02   282.29  1365.21 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -5412.145    411.040  -13.17   &lt;2e-16 ***
height        178.308      7.488   23.81   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 422.3 on 548 degrees of freedom
Multiple R-squared:  0.5085,    Adjusted R-squared:  0.5076 
F-statistic:   567 on 1 and 548 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb29" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">model_parameters</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Parameter   | Coefficient |     SE |               95% CI | t(548) |      p
---------------------------------------------------------------------------
(Intercept) |    -5412.14 | 411.04 | [-6219.55, -4604.74] | -13.17 | &lt; .001
height      |      178.31 |   7.49 | [  163.60,   193.02] |  23.81 | &lt; .001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre data-code-line-numbers=""><code>
Uncertainty intervals (equal-tailed) and p-values (two-tailed) computed
  using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="tidy-approach-tidymodels" class="level3"><h3 class="anchored" data-anchor-id="tidy-approach-tidymodels">Tidy approach (tidymodels)</h3>
<div class="cell">
<div class="sourceCode" id="cb32" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">model_lm_tidy</span> <span class="op">&lt;-</span> <span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">height</span>, data <span class="op">=</span> <span class="va">BirthWeight</span><span class="op">)</span></span>
<span><span class="va">model_lm_tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>parsnip model object


Call:
stats::lm(formula = weight ~ height, data = data)

Coefficients:
(Intercept)       height  
    -5412.1        178.3  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb34" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tidy</span><span class="op">(</span><span class="va">model_lm_tidy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -5412.    411.       -13.2 1.35e-34
2 height          178.      7.49      23.8 1.40e-86</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section><section id="summary-table" class="level3"><h3 class="anchored" data-anchor-id="summary-table">Summary table</h3>
<p>All the estimates and statistics of interest for the regression model are presented in the following summary table (<a href="#fig-eq_table" class="quarto-xref">Figure&nbsp;<span>27.8</span></a>):</p>
<div class="cell">
<div id="fig-eq_table" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><table class="table" style="font-size: 16px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:left;">
p_value
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
intercept
</td>
<td style="text-align:right;">
-5412.15
</td>
<td style="text-align:right;">
411.04
</td>
<td style="text-align:right;">
-13.17
</td>
<td style="text-align:left;">
&lt;0.001
</td>
<td style="text-align:right;">
-6219.55
</td>
<td style="text-align:right;">
-4604.74
</td>
</tr>
<tr>
<td style="text-align:left;">
height
</td>
<td style="text-align:right;">
178.31
</td>
<td style="text-align:right;">
7.49
</td>
<td style="text-align:right;">
23.81
</td>
<td style="text-align:left;">
&lt;0.001
</td>
<td style="text-align:right;">
163.60
</td>
<td style="text-align:right;">
193.02
</td>
</tr>
</tbody>
</table>
<figcaption class="figure-caption">Figure&nbsp;27.8: The linear regression table.</figcaption></figure>
</div>
</div>
<p>&nbsp;</p>
</section></section><section id="verifying-model-assumptions" class="level2" data-number="27.10"><h2 data-number="27.10" class="anchored" data-anchor-id="verifying-model-assumptions">
<span class="header-section-number">27.10</span> Verifying Model Assumptions</h2>
<p>Specific assumptions have to be met for reliable hypothesis tests and confidence intervals in simple linear regression: linearity of the data, independence of the residuals, normality of the residuals, and equality of variance of the residuals.</p>
<p>We will describe some statistical test and diagnostic plots in R for testing the assumptions underlying linear regression model.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variations or different versions of the statistical tests may have different results.</p>
</div>
</div>
<p>&nbsp;</p>
<section id="linearity-of-the-data" class="level3"><h3 class="anchored" data-anchor-id="linearity-of-the-data">Linearity of the data</h3>
<div class="content-box-yellow">
<p>Linear association between the independent variable x and the dependent variable (outcome) y.</p>
</div>
<section id="plot-residuals-vs-fitted-values" class="level4"><h4 class="anchored" data-anchor-id="plot-residuals-vs-fitted-values">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Plot: Residuals vs Fitted values</h4>
<div class="cell">
<div class="sourceCode" id="cb36" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diagnostic_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">model_lm</span>, panel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">diagnostic_plots</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$NCV</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_regression_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Residuals vs Fitted values</strong> plot is used to check the linear association assumption. We would expect to see a random scatter of points around the horizontal dashed line at zero, as demonstrated in our example. The green line is a scatter plot smoother, showing the average value of the residuals corresponding to each fitted value. <strong>A horizontal green line, without noticeable patterns or curvature, indicates a linear association</strong>.</p>
<p>&nbsp;</p>
</section></section><section id="independence-of-the-residuals" class="level3"><h3 class="anchored" data-anchor-id="independence-of-the-residuals">Independence of the residuals</h3>
<div class="content-box-yellow">
<p>The residuals (or errors) resulting from the model should be independent of each other.</p>
</div>
<section id="statistical-test-durbin-watson-test" class="level4"><h4 class="anchored" data-anchor-id="statistical-test-durbin-watson-test">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Statistical test: Durbin-Watson test</h4>
<p>We can perform a Durbin-Watson-Test to check for autocorrelated residuals (a p-value &lt; 0.05 indicates autocorrelated residuals).</p>
<div class="cell">
<div class="sourceCode" id="cb38" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">126</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_autocorrelation.html">check_autocorrelation</a></span><span class="op">(</span><span class="va">model_lm</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>OK: Residuals appear to be independent and not autocorrelated (p = 0.128).</code></pre>
</div>
</div>
<p>&nbsp;</p>
</section></section><section id="normality-of-the-residuals" class="level3"><h3 class="anchored" data-anchor-id="normality-of-the-residuals">Normality of the residuals</h3>
<div class="content-box-yellow">
<p>The residuals should be normally distributed.</p>
</div>
<section id="statistical-test-shapiro-test" class="level4"><h4 class="anchored" data-anchor-id="statistical-test-shapiro-test">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Statistical test: Shapiro test</h4>
<div class="cell">
<div class="sourceCode" id="cb40" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/performance/reference/check_normality.html">check_normality</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Warning: Non-normality of residuals detected (p = 0.021).</code></pre>
</div>
</div>
<p>The function performs a <code>shapiro.test</code> and checks the standardized residuals for normal distribution. According to the documentation “this formal test almost always yields significant results for the distribution of residuals for large samples and visual inspection (e.g., Q-Q plots) are preferable.”</p>
</section><section id="plot-normal-q-q-plot" class="level4"><h4 class="anchored" data-anchor-id="plot-normal-q-q-plot">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Plot: Normal Q-Q plot</h4>
<div class="cell">
<div class="sourceCode" id="cb42" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diagnostic_plots</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$QQ</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_regression_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Normal Q-Q plot is used to examine whether the residuals are roughly normally distributed. Ideally, the standardized residuals points should follow the green line. In our example, the normal Q-Q normal plot does not deviate greatly from normal.</p>
<p>&nbsp;</p>
</section></section><section id="equality-of-variance-of-the-residuals-homoscedasticity" class="level3"><h3 class="anchored" data-anchor-id="equality-of-variance-of-the-residuals-homoscedasticity">Equality of variance of the residuals (Homoscedasticity)</h3>
<div class="content-box-yellow">
<p>The spread or dispersion of the residuals should remain roughly the same for all values of the X variable.</p>
</div>
<section id="statistical-test-breusch-pagan-test" class="level4"><h4 class="anchored" data-anchor-id="statistical-test-breusch-pagan-test">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Statistical test: Breusch-Pagan test</h4>
<p>The most common test for checking equality of variance of the residuals (homoskedasticity) is the Breush-Pagan test (a p-value &lt; 0.05 indicates presence of heteroscedasticity).</p>
<p>The original version of Breusch-Pagan test:</p>
<div class="cell">
<div class="sourceCode" id="cb44" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">model_lm</span>, studentize <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    Breusch-Pagan test

data:  model_lm
BP = 2.3929, df = 1, p-value = 0.1219</code></pre>
</div>
</div>
<p>However, the <strong>studentized</strong> BP test (which is the default) is more robust than the original one:</p>
<div class="cell">
<div class="sourceCode" id="cb46" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">lmtest</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>
    studentized Breusch-Pagan test

data:  model_lm
BP = 1.9331, df = 1, p-value = 0.1644</code></pre>
</div>
</div>
</section><section id="plot-square-root-of-standardized-residuals-vs-fitted-values" class="level4"><h4 class="anchored" data-anchor-id="plot-square-root-of-standardized-residuals-vs-fitted-values">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Plot: Square root of standardized residuals vs Fitted values</h4>
<div class="cell">
<div class="sourceCode" id="cb48" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diagnostic_plots</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$HOMOGENEITY</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_regression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot checks the assumption of equal variance of the residuals (homoscedasticity). To verify the assumption, we plot the square root of standardized residuals against the fitted values from the regression. In this case, the residuals are re-scaled and all values are positive. A horizontal line with equally spread points would be the desired pattern, as demonstrated in our example. However, if the spread of residuals widens or narrows systematically as we move along the x-axis, it indicates a violation of homoscedasticity.</p>
<p>&nbsp;</p>
</section></section><section id="influential-observations-in-the-data" class="level3"><h3 class="anchored" data-anchor-id="influential-observations-in-the-data">Influential observations in the data</h3>
<div class="content-box-yellow">
<p>The dataset should not include data points with exceptional influence on the model.</p>
</div>
<section id="plot-standardized-residuals-vs-leverage" class="level4"><h4 class="anchored" data-anchor-id="plot-standardized-residuals-vs-leverage">
<svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; Plot: Standardized residuals vs Leverage</h4>
<div class="cell">
<div class="sourceCode" id="cb50" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diagnostic_plots</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>$OUTLIERS</code></pre>
</div>
<div class="cell-output-display">
<p><img src="simple_regression_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot is used to detect influential observations. These data are outlier points that might have a substantial impact on the regression model’s results when included or excluded from the analysis. If any point in this plot fall outside the dashed green lines then it is considered an influential observation. In our example, all the data points are inside the dashed green lines suggesting that none of the observations is influential on the fitted model.</p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Comment
</div>
</div>
<div class="callout-body-container callout-body">
<p>The standardized residual is the residual divided by its standard deviation. The standardization, which results in a mean of zero and a variance of one, enables the residuals to be compared on the “standard scale”. When a standardized residual falls within the range of +/- 2, it indicates an unusual observation, while a value between +/- 3 indicates a highly unusual data”.</p>
</div>
</div>
<p>&nbsp;</p>
</section></section></section><section id="model-evaluation" class="level2" data-number="27.11"><h2 data-number="27.11" class="anchored" data-anchor-id="model-evaluation">
<span class="header-section-number">27.11</span> Model evaluation</h2>
<p>Two related measures are typically used to evaluate the linear regression model: the residual standard error (RSE) and the coefficient of determination <span class="math inline">\(R^2\)</span>.</p>
<section id="residual-standard-error-rse" class="level3"><h3 class="anchored" data-anchor-id="residual-standard-error-rse">Residual standard error (RSE)</h3>
<p>The residual standard error is the square root of the residual variance <span class="math inline">\(\sigma^2_{e}\)</span> that we have already calculated. It informs us about the average error of the regression model in terms of the units of the outcome variable. Lower values are better because it indicates that the observations are closer to the fitted line. In our example:</p>
<p><span id="eq-rse"><span class="math display">\[\ RSE = \sqrt{\frac{SS_{residuals}}{n-k}} \tag{27.16}\]</span></span></p>
</section><section id="in-r-3" class="level3"><h3 class="anchored" data-anchor-id="in-r-3">In R:</h3>
<div class="cell">
<div class="sourceCode" id="cb52" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_e</span><span class="op">)</span></span>
<span><span class="va">rse</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>         [,1]
[1,] 422.2874</code></pre>
</div>
</div>
</section><section id="coefficient-of-determination-r2" class="level3"><h3 class="anchored" data-anchor-id="coefficient-of-determination-r2">Coefficient of determination <span class="math inline">\(R^2\)</span>
</h3>
<p>The regression model allows us to divide the total variation in the outcome into two components: one explained by the model, and the other that remains unexplained by the model.</p>
<p><span class="math display">\[
\mathrm{SS}_{\mathrm{total}} = \mathrm{SS}_{\mathrm{model}} + \mathrm{SS}_{\mathrm{residual}}
\]</span></p>
<p>In matrix notation:</p>
<ul>
<li>the sum of squares total is defined as:</li>
</ul>
<p><span class="math display">\[
\mathrm{SS}_{total} = (\mathbf{Y} - \bar{\mathbf{Y}})^2 = (\mathbf{Y} - \bar{\mathbf{Y}})^\intercal(\mathbf{Y} - \bar{\mathbf{Y}})
\]</span></p>
<ul>
<li>the residual sum of squares is:</li>
</ul>
<p><span class="math display">\[
SS_{residuals} = \mathbf{e}^2 =\mathbf{e}^\intercal\mathbf{e}
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\mathrm{SS}_{\mathrm{model}} = \mathrm{SS}_{\mathrm{total}} - \mathrm{SS}_{\mathrm{residual}}
\]</span></p>
<p>The <strong>coefficient of determination</strong>, <span class="math inline">\(R^2\)</span>, indicates the percentage of the total variation in the dependent variable Y that can be explained by the regression model (in this simple case the independent variable X). Hence, it is a measure of the <strong>‘goodness of fit’</strong> of the regression line to the data.</p>
<p><span id="eq-r2"><span class="math display">\[\ R^2 = \frac{\ explained \ \ variation}{total \ \ variation} = \frac{SS_{model}}{SS_{total}} = 1- \frac{SS_{residual}}{SS_{total}} \tag{27.17}\]</span></span></p>
<div class="cell">
<div class="sourceCode" id="cb54" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dev_mean</span> <span class="op">&lt;-</span> <span class="va">Y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="va">ss_total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">dev_mean</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">dev_mean</span></span>
<span><span class="va">R_square</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">ss_e</span> <span class="op">/</span> <span class="va">ss_total</span><span class="op">)</span></span>
<span><span class="va">R_square</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>         [,1]
[1,] 0.508539</code></pre>
</div>
</div>
<p>The R-squared measure ranges between 0 and 1. When <span class="math inline">\(R^2\)</span> approaches 1 indicates that a substantial proportion of the variation in the dependent variable Y has been explained by the regression model. Conversely, when it nears 0, it implies that the regression model has not effectively explained the majority of the variation in the outcome.</p>
<div class="content-box-blue">
<p>In our example, <span class="math inline">\(R^2 = 0.508\)</span> indicates that about 50.8% of the variation in infant’s body weight can be explained by the variation of the infant’s body height.</p>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M123.6 391.3c12.9-9.4 29.6-11.8 44.6-6.4c26.5 9.6 56.2 15.1 87.8 15.1c124.7 0 208-80.5 208-160s-83.3-160-208-160S48 160.5 48 240c0 32 12.4 62.8 35.7 89.2c8.6 9.7 12.8 22.5 11.8 35.5c-1.4 18.1-5.7 34.7-11.3 49.4c17-7.9 31.1-16.7 39.4-22.7zM21.2 431.9c1.8-2.7 3.5-5.4 5.1-8.1c10-16.6 19.5-38.4 21.4-62.9C17.7 326.8 0 285.1 0 240C0 125.1 114.6 32 256 32s256 93.1 256 208s-114.6 208-256 208c-37.1 0-72.3-6.4-104.1-17.9c-11.9 8.7-31.3 20.6-54.3 30.6c-15.1 6.6-32.3 12.6-50.1 16.1c-.8 .2-1.6 .3-2.4 .5c-4.4 .8-8.7 1.5-13.2 1.9c-.2 0-.5 .1-.7 .1c-5.1 .5-10.2 .8-15.3 .8c-6.5 0-12.3-3.9-14.8-9.9c-2.5-6-1.1-12.8 3.4-17.4c4.1-4.2 7.8-8.7 11.3-13.5c1.7-2.3 3.3-4.6 4.8-6.9c.1-.2 .2-.3 .3-.5z"></path></svg> Comment
</div>
</div>
<div class="callout-body-container callout-body">
<p>In simple linear regression <span class="math inline">\(\sqrt{0.5085} = 0.713\)</span> which equals to the Pearson’s correlation coefficient r.</p>
</div>
</div>
</section></section><section id="present-the-results" class="level2" data-number="27.12"><h2 data-number="27.12" class="anchored" data-anchor-id="present-the-results">
<span class="header-section-number">27.12</span> Present the results</h2>
<div class="cell">
<div class="sourceCode" id="cb56" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://easystats.github.io/report/reference/report.html">report</a></span><span class="op">(</span><span class="va">model_lm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>We fitted a linear model (estimated using OLS) to predict weight with height
(formula: weight ~ height). The model explains a statistically significant and
substantial proportion of variance (R2 = 0.51, F(1, 548) = 567.04, p &lt; .001,
adj. R2 = 0.51). The model's intercept, corresponding to height = 0, is at
-5412.14 (95% CI [-6219.55, -4604.74], t(548) = -13.17, p &lt; .001). Within this
model:

  - The effect of height is statistically significant and positive (beta =
178.31, 95% CI [163.60, 193.02], t(548) = 23.81, p &lt; .001; Std. beta = 0.71,
95% CI [0.65, 0.77])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
<p>We can use the above information to write up a final report:</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#1DC5CE;overflow:visible;position:relative;"><path d="M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"></path></svg> Final report
</div>
</div>
<div class="callout-body-container callout-body">
<p>In summary, the regression coefficient of the height is positive and significantly different from zero (p &lt; 0.001). There is on average an increase of 178 g (<span class="math inline">\(95\%\)</span>CI: 164 to 193) in weight for every 1 cm increase in height. The model explains a substantial proportion of variance (51% of the variation in infant’s body weight can be explained by the variation of the infant’s body height).</p>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./correlation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Correlation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chi_square.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Chi-sqaure test of independence</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2023, Konstantinos I. Bougioukas</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><div class="page-columns page-rows-contents page-layout-article"><div class="social-share">
<a href="https://twitter.com/share?url=https://practical-stats-med-r.netlify.app/&amp;text=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="twitter"><i class="fab fa-twitter fa-fw fa-lg"></i></a><a href="https://www.linkedin.com/shareArticle?url=https://practical-stats-med-r.netlify.app/&amp;title=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a><a href="https://www.facebook.com/sharer.php?u=https://practical-stats-med-r.netlify.app/" target="_blank" class="facebook"><i class="fab fa-facebook-f fa-fw fa-lg"></i></a>
</div></div>



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>