<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.322">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Practical Statistics in Medicine with R - 11&nbsp; Data visualization with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./introduction.html" rel="next">
<link href="./transformation.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/social-share.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/social-share-0.1.0/all.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_rstudio.html">Part 1: R Basics</a></li><li class="breadcrumb-item"><a href="./ggplot2.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Practical Statistics in Medicine with R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Part 1: R Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R via RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rstudio_projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with RStudio Projects and writing R scripts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./calculations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R as calculator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">R objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data structures in R: 1-Dimensional Vectors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data structures in R: matrices and arrays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data structures in R: lists and data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transformation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data transformation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ggplot2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Basic concepts of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prob_distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Descriptive statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Foundations for statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Two-sample t-test (Student’s t-test)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wmw_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Wilcoxon-Mann-Whitney (Mann-Whitney U) test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paired_t_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Paired t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wilcoxon_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Wilcoxon Signed-Rank test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">One-way ANOVA test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kruskal_wallis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Kruskal-Wallis test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Repeated Measures ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./friedman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Friedman test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi_square.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Chi-sqaure test of independence</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fisher_exact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fisher’s exact test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mcnemar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">McNemar’s test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cochran.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Cochran’s Q Test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Measures of relative and absolute reliability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diagnostic_accuracy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Measures of diagnostic test accuracy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./roc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Receiver Operating Characteristic (ROC) curve</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Sample size calculation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction-to-ggplot2" id="toc-introduction-to-ggplot2" class="nav-link active" data-scroll-target="#introduction-to-ggplot2"><span class="header-section-number">11.1</span> Introduction to ggplot2</a></li>
  <li>
<a href="#covid-19-data" id="toc-covid-19-data" class="nav-link" data-scroll-target="#covid-19-data"><span class="header-section-number">11.2</span> Covid-19 data</a>
  <ul class="collapse">
<li><a href="#data-preparation-for-the-plots" id="toc-data-preparation-for-the-plots" class="nav-link" data-scroll-target="#data-preparation-for-the-plots">Data preparation for the plots</a></li>
  </ul>
</li>
  <li>
<a href="#basic-steps-for-creating-a-ggplot-graph" id="toc-basic-steps-for-creating-a-ggplot-graph" class="nav-link" data-scroll-target="#basic-steps-for-creating-a-ggplot-graph"><span class="header-section-number">11.3</span> Basic steps for creating a ggplot graph</a>
  <ul class="collapse">
<li><a href="#step-0-start-with-a-default-blank-ggplot-object" id="toc-step-0-start-with-a-default-blank-ggplot-object" class="nav-link" data-scroll-target="#step-0-start-with-a-default-blank-ggplot-object">Step 0: Start with a default blank ggplot object</a></li>
  <li><a href="#step-1-add-the-dataset-and-define-the-x-and-y" id="toc-step-1-add-the-dataset-and-define-the-x-and-y" class="nav-link" data-scroll-target="#step-1-add-the-dataset-and-define-the-x-and-y">Step 1: Add the dataset and define the x and y</a></li>
  <li><a href="#step-2-add-geometry" id="toc-step-2-add-geometry" class="nav-link" data-scroll-target="#step-2-add-geometry">Step 2: Add geometry</a></li>
  <li><a href="#step-3-add-aesthetics-to-geometry" id="toc-step-3-add-aesthetics-to-geometry" class="nav-link" data-scroll-target="#step-3-add-aesthetics-to-geometry">Step 3: Add aesthetics to geometry</a></li>
  </ul>
</li>
  <li><a href="#add-a-new-geom-text-information-for-each-point" id="toc-add-a-new-geom-text-information-for-each-point" class="nav-link" data-scroll-target="#add-a-new-geom-text-information-for-each-point"><span class="header-section-number">11.4</span> Add a new geom (text information for each point)</a></li>
  <li>
<a href="#change-the-default-properties-of-the-plot-with-scales" id="toc-change-the-default-properties-of-the-plot-with-scales" class="nav-link" data-scroll-target="#change-the-default-properties-of-the-plot-with-scales"><span class="header-section-number">11.5</span> Change the default properties of the plot with <em>scales</em></a>
  <ul class="collapse">
<li><a href="#change-the-scale-of-the-y-axis" id="toc-change-the-scale-of-the-y-axis" class="nav-link" data-scroll-target="#change-the-scale-of-the-y-axis">Change the scale of the y axis</a></li>
  <li><a href="#change-the-default-point-shapes" id="toc-change-the-default-point-shapes" class="nav-link" data-scroll-target="#change-the-default-point-shapes">Change the default point shapes</a></li>
  <li><a href="#change-the-default-colors" id="toc-change-the-default-colors" class="nav-link" data-scroll-target="#change-the-default-colors">Change the default colors</a></li>
  </ul>
</li>
  <li><a href="#modify-axis-legend-and-plot-labels-with-labs" id="toc-modify-axis-legend-and-plot-labels-with-labs" class="nav-link" data-scroll-target="#modify-axis-legend-and-plot-labels-with-labs"><span class="header-section-number">11.6</span> Modify axis, legend, and plot labels with <em>labs</em></a></li>
  <li>
<a href="#modify-theme-elements-with-theme" id="toc-modify-theme-elements-with-theme" class="nav-link" data-scroll-target="#modify-theme-elements-with-theme"><span class="header-section-number">11.7</span> Modify theme elements with <em>theme</em></a>
  <ul class="collapse">
<li><a href="#a.-element_line" id="toc-a.-element_line" class="nav-link" data-scroll-target="#a.-element_line">A. element_line()</a></li>
  <li><a href="#b.-element_text" id="toc-b.-element_text" class="nav-link" data-scroll-target="#b.-element_text">B. element_text()</a></li>
  <li><a href="#c.-element_rect" id="toc-c.-element_rect" class="nav-link" data-scroll-target="#c.-element_rect">C. element_rect()</a></li>
  </ul>
</li>
  <li>
<a href="#themes" id="toc-themes" class="nav-link" data-scroll-target="#themes"><span class="header-section-number">11.8</span> Themes</a>
  <ul class="collapse">
<li><a href="#default-ggplot-theme" id="toc-default-ggplot-theme" class="nav-link" data-scroll-target="#default-ggplot-theme">Default ggplot theme</a></li>
  <li><a href="#predefined-theme" id="toc-predefined-theme" class="nav-link" data-scroll-target="#predefined-theme">Predefined theme</a></li>
  <li><a href="#publication-quality-figure" id="toc-publication-quality-figure" class="nav-link" data-scroll-target="#publication-quality-figure">Publication Quality Figure</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro_rstudio.html">Part 1: R Basics</a></li><li class="breadcrumb-item"><a href="./ggplot2.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-ggplot2" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data visualization with ggplot2</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>In this textbook, the <a href="https://ggplot2.tidyverse.org">ggplot2</a> package is the preferred tool for creating plots. With this tool and its extensions, R users can produce elegant, sophisticated, and professional-looking types of graphs that communicate results efficiently to the desired audience.</p>
<p>When we have finished this chapter, we should be able to:</p>
<div class="callout callout-style-default callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning objectives
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Use <code>ggplot2</code> to generate publication-ready graphics.</li>
<li>Understand the basic grammar of graphics, including the aesthetics and geometry layers, adding statistics, transforming scales, and coloring by groups.</li>
<li>Understand how to save plots in a variety of formats.</li>
<li>Find extensions for <code>ggplot2</code> to produce custom graphics.</li>
</ul>
</div>
</div>
<p>&nbsp;</p>
<section id="introduction-to-ggplot2" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="introduction-to-ggplot2">
<span class="header-section-number">11.1</span> Introduction to ggplot2</h2>
<p>The main idea of ggplot2 is that any plot can be made up of the following principal components:</p>
<ul>
<li>
<strong>data</strong> and <strong>coordinate system</strong>
</li>
<li>
<strong>geometric objects</strong> such as points, bars, lines.</li>
<li>
<strong>aesthetic mappings</strong> that describe how variables are mapped to visual properties or aesthetics (e.g., color, size, shape) of the graph.</li>
<li>
<strong>themes</strong> that style all the visual elements which are not part of data.</li>
</ul>
<p>The key to understanding ggplot2 is thinking about a figure in <strong>multiple layers</strong>.</p>
<div id="fig-layers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/layers.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.1: The ggplot figure is built layer by layer by adding new graphical elements.</figcaption></figure>
</div>
</section><section id="covid-19-data" class="level2 page-columns page-full" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="covid-19-data">
<span class="header-section-number">11.2</span> Covid-19 data</h2>
<p>In this Chapter, we will explore graphically the association between a country’s wealth and COVID-19 cases. However, there more variables that may be associated to both wealth and COVID-19 cases such as testing rate. For example, wealthier countries may have a national program to distribute tests for the virus, provide advice on how to apply a self-test and report the results to a national organization. Without the resources of wealthy countries to buy and distribute tests, a lack of reported cases in developing countries could indicate a scarcity of testing. In this case, using diagrams to depict multivariable associations may be helpful.</p>
<div class="cell">
<div class="sourceCode" id="cb1" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="va">covid_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"covid_data.csv"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a look at the types of variables:</p>
<div class="cell">
<div class="sourceCode" id="cb2" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">covid_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre data-code-line-numbers=""><code>Rows: 132,236
Columns: 12
$ iso3c           &lt;chr&gt; "ABW", "ABW", "ABW", "ABW", "ABW", "ABW", "ABW", "ABW"…
$ country         &lt;chr&gt; "Aruba", "Aruba", "Aruba", "Aruba", "Aruba", "Aruba", …
$ date            &lt;chr&gt; "3/13/2020", "3/14/2020", "3/15/2020", "3/16/2020", "3…
$ confirmed       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ deaths          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ total_tests     &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ region          &lt;chr&gt; "Latin America &amp; Caribbean", "Latin America &amp; Caribbea…
$ income          &lt;chr&gt; "High income", "High income", "High income", "High inc…
$ population      &lt;dbl&gt; 106766, 106766, 106766, 106766, 106766, 106766, 106766…
$ pop_density     &lt;dbl&gt; 593.1, 593.1, 593.1, 593.1, 593.1, 593.1, 593.1, 593.1…
$ life_expectancy &lt;dbl&gt; 76.3, 76.3, 76.3, 76.3, 76.3, 76.3, 76.3, 76.3, 76.3, …
$ gdp_capita      &lt;dbl&gt; 26631.5, 26631.5, 26631.5, 26631.5, 26631.5, 26631.5, …</code></pre>
</div>
</div>
<p>The data frame contains 132236 rows and 12 variables that are described as follows:</p>
<ul>
<li><p><strong>iso3c:</strong> ISO3c country code as defined by ISO 3166-1 alpha-3</p></li>
<li><p><strong>country:</strong> Country name</p></li>
<li><p><strong>date:</strong> Calendar date</p></li>
<li><p><strong>confirmed:</strong> Confirmed Covid-19 cases as reported by JHU CSSE<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (accumulated)</p></li>
<li><p><strong>deaths:</strong> Covid-19-related deaths as reported by JHU CSSE (accumulated)</p></li>
<li><p><strong>total_tests:</strong> Accumulated test counts as reported by Our World in Data</p></li>
<li><p><strong>region:</strong> Country region as classified by the World Bank (time-stable): East Asia &amp; Pacific, Europe &amp; Central Asia, Latin America &amp; Caribbean, Middle East &amp; North Africa, North America, South Asia, Sub-Saharan Africa.</p></li>
<li><p><strong>income:</strong> Country income group as classified by the World Bank (time-stable)</p></li>
<li><p><strong>population:</strong> Country population as reported by the World Bank (original identifier ‘SP.POP.TOTL’, time-stable)</p></li>
<li><p><strong>pop_density:</strong> Country population density as reported by the World Bank (original identifier ‘EN.POP.DNST’, time-stable)</p></li>
<li><p><strong>life_expectancy</strong> Average life expectancy at birth of country citizens in years as reported by the World Bank (original identifier ‘SP.DYN.LE00.IN’, time-stable)</p></li>
<li><p><strong>gdp_capita:</strong> Country gross domestic product (GDP) per capita, measured in 2010 US-<span class="math inline">\(\$\)</span> as reported by the World Bank (original identifier ‘NY.GDP.PCAP.KD’, time-stable)</p></li>
</ul>
<div class="no-row-height column-margin column-container"><li id="fn1"><p><sup>1</sup>&nbsp;JHU CSSE: Johns Hopkins Coronavirus Resource Center</p></li></div><section id="data-preparation-for-the-plots" class="level3"><h3 class="anchored" data-anchor-id="data-preparation-for-the-plots">Data preparation for the plots</h3>
<p>The data cover a period from 1/1/2020 to 9/9/2021. Suppose we are interested in investigating countries with population more than 1 million up to June, 12 2021 and we want also to calculate the cases per 100000 inhabitants and tests per capita:</p>
<div class="cell">
<div class="sourceCode" id="cb4" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">covid_data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>date <span class="op">=</span> <span class="fu">mdy</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>         region <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">region</span><span class="op">)</span>,</span>
<span>         income <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>,</span>
<span>         cases_per_100k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">confirmed</span> <span class="op">/</span> <span class="va">population</span> <span class="op">*</span> <span class="fl">100000</span>, digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>         tests_per_capita <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">total_tests</span> <span class="op">/</span> <span class="va">population</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">==</span> <span class="st">"2021-06-12"</span>, <span class="va">population</span> <span class="op">&gt;</span> <span class="fl">1000000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="basic-steps-for-creating-a-ggplot-graph" class="level2 page-columns page-full" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="basic-steps-for-creating-a-ggplot-graph">
<span class="header-section-number">11.3</span> Basic steps for creating a ggplot graph</h2>
<p>The <a href="https://ggplot2.tidyverse.org">ggplot2</a> is contained within the <a href="https://tidyverse.tidyverse.org">tidyverse</a> package, so it is installed automatically when we install the tidyverse “meta” package. Furthermore, it is one of the core packages of the tidyverse that are loaded at R session when we run the command <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code>.</p>
<section id="step-0-start-with-a-default-blank-ggplot-object" class="level3"><h3 class="anchored" data-anchor-id="step-0-start-with-a-default-blank-ggplot-object">Step 0: Start with a default blank ggplot object</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-blank" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-blank-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.2: A default blank ggplot object.</figcaption></figure>
</div>
</div>
</div>
</section><section id="step-1-add-the-dataset-and-define-the-x-and-y" class="level3"><h3 class="anchored" data-anchor-id="step-1-add-the-dataset-and-define-the-x-and-y">Step 1: Add the dataset and define the x and y</h3>
<p>The <code>ggplot()</code> function has <strong>two basic named arguments</strong>. The first argument, <code>data</code>, specifies the dataset that we are going to use for the plot. The second argument, <code>mapping</code>, defines which variables are mapped to x and y aesthetics of position.</p>
<p>Let’s provide the dataset “dat” to the first argument of <code>ggplot()</code> and mapp the variable <code>gdp_capita</code> to the x position and the variable <code>cases_per_100K</code> to the y position inside the <code>aes()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-map_xy" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-map_xy-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.3: Variables are mapped to x and y axes on a canvas with grid lines.</figcaption></figure>
</div>
</div>
</div>
<p>Note that we don’t usually have to spell out the names of the arguments <code>data</code> and <code>mapping</code>. Therefore, the following command is equivalent:</p>
<div class="cell">
<div class="sourceCode" id="cb7" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we can observe, only a grey canvas is created when running the code. This is because we also need to provide a geometry!</p>
</section><section id="step-2-add-geometry" class="level3"><h3 class="anchored" data-anchor-id="step-2-add-geometry">Step 2: Add geometry</h3>
<p>Geoms are the geometric objects that make up ggplot2 visualizations. Each geom is called with a function that begins with “<strong>geom_</strong>” and ends with the name of the geometric object (e.g., point, bar, line) (<a href="#tbl-geometry" class="quarto-xref">Table&nbsp;<span>11.1</span></a>).</p>
<div id="tbl-geometry" class="anchored">
<table class="table">
<caption>Table&nbsp;11.1: Common geometries used in ggplot graphs.</caption>
<thead><tr class="header">
<th>geom_</th>
<th style="text-align: center;">Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>geom_point()</td>
<td style="text-align: center;"><img src="images/geom_point.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="even">
<td>geom_line()</td>
<td style="text-align: center;"><img src="images/geom_line.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="odd">
<td>geom_text()</td>
<td style="text-align: center;"><img src="images/geom_text.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="even">
<td>geom_label()</td>
<td style="text-align: center;"><img src="images/geom_label.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="odd">
<td>geom_histogram()</td>
<td style="text-align: center;"><img src="images/geom_histogram.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="even">
<td>geom_density()</td>
<td style="text-align: center;"><img src="images/geom_density.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="odd">
<td>geom_bar()</td>
<td style="text-align: center;"><img src="images/geom_bar.png" class="img-fluid" style="width:20.0%"></td>
</tr>
<tr class="even">
<td>geom_boxplot()</td>
<td style="text-align: center;"><img src="images/geom_boxplot.png" class="img-fluid" style="width:20.0%"></td>
</tr>
</tbody>
</table>
</div>
<p>Let’s select which style we want to use. We are interested in exploring the association between two numeric variables with a scatter plot (see also <a href="correlation.html" class="quarto-xref"><span>Chapter&nbsp;26</span></a>). So, we will add points using a geom layer called <code>geom_point</code>. In this case, <code>geom_point()</code> will inherit the <code>x</code> and <code>y</code> aesthetics from the <code>ggplot()</code> function:</p>
<div class="cell" data-source-line-numbers="2">
<div class="sourceCode" id="cb8" data-source-line-numbers="2" data-code-line-numbers="2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="step-3-add-aesthetics-to-geometry" class="level3 page-columns page-full"><h3 class="anchored" data-anchor-id="step-3-add-aesthetics-to-geometry">Step 3: Add aesthetics to geometry</h3>
<p>Each “geom” has a number of aesthetics that define its visual properties. We can map our data to anything that our “geom” supports. For example, <code>geom_point()</code> understands the following aesthetics (required aesthetics are in bold): <strong>x</strong>, <strong>y</strong>, alpha, color, fill, group, shape, size, stroke.</p>
<p>So, if we want to add more variables to a plot, we can use aesthetics like color, shape, and size.</p>
<p><strong>A. <code>color</code> aesthetics</strong></p>
<p>Color is an important characteristic of graphs. If we decide to use color, we should consider which colors to use and where to use them. Color palettes (or colormaps) are classified into three main categories in <code>ggplot2</code>:</p>
<ol type="1">
<li>
<strong>Sequential</strong> (continuous or discrete) palette that is used for <strong>quantitative</strong> data. One variation of a unique color varying from dark to light (<a href="#fig-sequential" class="quarto-xref">Figure&nbsp;<span>11.4</span></a>).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-sequential" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/sequential.PNG" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.4: Example of sequential color scales.</figcaption></figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li>
<strong>Diverging</strong> palette that creates a gradient between three different colors, allowing us to easily identify low, middle, and high values within our data (<a href="#fig-gradient" class="quarto-xref">Figure&nbsp;<span>11.5</span></a>).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gradient" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/gradient.PNG" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.5: Example diverging color scales.</figcaption></figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>
<strong>Qualitative</strong> palette that is used mainly for discrete or <strong>categorical</strong> data. This palette is consisted from a discrete set of distinct colors with no implied order (<a href="#fig-qualitative" class="quarto-xref">Figure&nbsp;<span>11.6</span></a>).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-qualitative" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/qualitative.PNG" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.6: Example qualitative color scales.</figcaption></figure>
</div>
</div>
</div>
<p>Now, suppose we want to group the points according to the categorical variable <code>region</code> using different colors, as follows:</p>
<div class="cell" data-source-line-numbers="2">
<div class="sourceCode" id="cb9" data-source-line-numbers="2" data-code-line-numbers="2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here, we added inside the <code>aes()</code> the color argument. The data of the categorical variable <code>region</code> mapped to color aesthetic of <code>geom_point</code>. Obviously, the qualitative palette of colors was applied automatically by <code>ggplot2</code>. Additionally, ggplot automatically created a legend to show the correspondence between the regions and colors.</p>
<p>It is crucial to understand the difference between including the color<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> argument <strong>inside</strong> or <strong>outside</strong> of the <code>aes()</code> function. For example, let’s run the following code:</p>
<div class="no-row-height column-margin column-container"><li id="fn2"><p><sup>2</sup>&nbsp;ggplot2 understands both color and colour as well as the short version col.</p></li></div><div class="cell" data-source-line-numbers="2">
<div class="sourceCode" id="cb10" data-source-line-numbers="2" data-code-line-numbers="2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this case, we set the color argument to a <strong>fixed value</strong> (“deeppink”) in the geom function instead of using <code>aes()</code>, so ggplot changed the color of the points “globally”.</p>
<p>In R, colors can be specified in quotes either by name (e.g., <code>"deeppink"</code>) or as a hexadecimal color (hex code) that starts with a <code>#</code> (e.g., <code>"#FF1493"</code>). In the following <a href="#tbl-colors" class="quarto-xref">Table&nbsp;<span>11.2</span></a> we present an example of a color palette:</p>
<div id="tbl-colors" class="anchored">
<table class="table">
<caption>Table&nbsp;11.2: Examples of name and hex color code of different colors.</caption>
<thead><tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Hex code</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\color{#FF7F50}{coral}\)</span></td>
<td style="text-align: left;">#FF7F50</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\color{#66CDAA}{aquamarine3}\)</span></td>
<td style="text-align: left;">#66CDAA</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\color{#76EE00}{chartreuse2}\)</span></td>
<td style="text-align: left;">#76EE00</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\color{#FFFF00}{yellow}\)</span></td>
<td style="text-align: left;">#FFFF00</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\color{#0000FF}{blue}\)</span></td>
<td style="text-align: left;">#0000FF</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\color{#A52A2A}{brown}\)</span></td>
<td style="text-align: left;">#A52A2A</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\color{#FF1493}{deeppink}\)</span></td>
<td style="text-align: left;">#FF1493</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\color{#000000}{black}\)</span></td>
<td style="text-align: left;">#000000</td>
</tr>
</tbody>
</table>
</div>
<p>The main advantage of the Hex color system is that it is very compact and we can pick out any color we desire.</p>
<p>&nbsp;</p>
<p><strong>B. <code>shape</code> aesthetics</strong></p>
<p>Alternatively, we can group the points according to the <code>region</code> variable using different point shapes, as follows:</p>
<div class="cell" data-source-line-numbers="2">
<div class="sourceCode" id="cb11" data-source-line-numbers="2" data-code-line-numbers="2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>shape <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We observe that <code>ggplot2</code> by default allows only six different point shapes to be displayed. However, we will see how to change this using appropriate <code>scales</code>.</p>
<p>The different points shapes symbols commonly used in R are shown in the <a href="#fig-shape_symbols" class="quarto-xref">Figure&nbsp;<span>11.7</span></a> below:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-shape_symbols" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-shape_symbols-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.7: Points shapes symbols and their codes commonly used in R.</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The point shapes from 0 to 14 have an outline (we use <code>color</code> to change the color).</li>
<li>The point shapes from 15 to 20 are solid shapes (we use <code>color</code> to change color).</li>
<li>Point shapes options from 21 to 25 allow us to use both the outline and the inside color, so they can be controlled separately (we use <code>color</code> to change the color of the outline and <code>fill</code> to change the inside color).</li>
</ul>
</div>
</div>
<p>The default <code>geom_point()</code> uses the shape symbol 19 that is a solid circle. If we decide to use a shape symbol between 21 and 25, we can set <code>color</code> and <code>fill</code> aesthetics to each point. The following examples help us understand how to set the color and fill arguments for the shape symbol 24 that is a triangle:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">shape 24</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">shape 24 + color</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">shape 24 + color + fill</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb12" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb13" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">24</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode" id="cb14" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">24</span>, color <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>&nbsp;</p>
<p><strong>C. <code>size</code> aesthetics</strong></p>
<p>Next, we can add a third variable <code>tests_per_capita</code> using the size aesthetic:</p>
<div class="cell" data-source-line-numbers="2">
<div class="sourceCode" id="cb15" data-source-line-numbers="2" data-code-line-numbers="2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="add-a-new-geom-text-information-for-each-point" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="add-a-new-geom-text-information-for-each-point">
<span class="header-section-number">11.4</span> Add a new geom (text information for each point)</h2>
<p>Let’s add the name of the country for each data point. The <code>geom_text_repel()</code> function from the add-on package <a href="https://ggrepel.slowkow.com/">ggrepel</a> allow us to add text labels for each data point that repel away from each other to avoid overlapping of the text.</p>
<div class="cell" data-source-line-numbers="3">
<div class="sourceCode" id="cb16" data-source-line-numbers="3" data-code-line-numbers="3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="change-the-default-properties-of-the-plot-with-scales" class="level2" data-number="11.5"><h2 data-number="11.5" class="anchored" data-anchor-id="change-the-default-properties-of-the-plot-with-scales">
<span class="header-section-number">11.5</span> Change the default properties of the plot with <em>scales</em>
</h2>
<section id="change-the-scale-of-the-y-axis" class="level3"><h3 class="anchored" data-anchor-id="change-the-scale-of-the-y-axis">Change the scale of the y axis</h3>
<div class="cell" data-source-line-numbers="4">
<div class="sourceCode" id="cb17" data-source-line-numbers="4" data-code-line-numbers="4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Continuous variable <code>tests_per_capital</code> mapped to size and categorical variable <code>region</code> mapped to color.</p>
</section><section id="change-the-default-point-shapes" class="level3"><h3 class="anchored" data-anchor-id="change-the-default-point-shapes">Change the default point shapes</h3>
<div>
<div class="sourceCode" id="cb18" data-source-line-numbers="3,9,12" data-code-line-numbers="3,9,12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># default</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, shape<span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># modified</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, shape<span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_shape_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">19</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-charts" class="cell quarto-layout-panel" data-source-line-numbers="3,9,12">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-charts-1.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(a) Default</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-charts-2.png" class="img-fluid figure-img" data-ref-parent="fig-charts" width="672"></p>
<figcaption class="figure-caption">(b) Modified</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.8: Change the default point shapes</figcaption><p></p>
</figure>
</div>
</div>
<p>However, when a variable is mapped to size (here, <code>test_per_capital</code>), it’s a good idea to not map a variable to shape (here, <code>region</code>). This is because it is difficult to compare the sizes of different shapes (e.g., a size 4 square with a size 4 triangle).</p>
</section><section id="change-the-default-colors" class="level3"><h3 class="anchored" data-anchor-id="change-the-default-colors">Change the default colors</h3>
<div>
<div class="sourceCode" id="cb19" data-source-line-numbers="3,9,12" data-code-line-numbers="3,9,12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># default</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># modified</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_jco</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-charts2" class="cell quarto-layout-panel" data-source-line-numbers="3,9,12">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts2-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-charts2-1.png" class="img-fluid figure-img" data-ref-parent="fig-charts2" width="672"></p>
<figcaption class="figure-caption">(a) Default</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-charts2-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-charts2-2.png" class="img-fluid figure-img" data-ref-parent="fig-charts2" width="672"></p>
<figcaption class="figure-caption">(b) Modified</figcaption></figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;11.9: Change the default colors</figcaption><p></p>
</figure>
</div>
</div>
</section></section><section id="modify-axis-legend-and-plot-labels-with-labs" class="level2" data-number="11.6"><h2 data-number="11.6" class="anchored" data-anchor-id="modify-axis-legend-and-plot-labels-with-labs">
<span class="header-section-number">11.6</span> Modify axis, legend, and plot labels with <em>labs</em>
</h2>
<div class="cell" data-source-line-numbers="6-13">
<div class="sourceCode" id="cb20" data-source-line-numbers="6-13" data-code-line-numbers="6-13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_jco</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data from {tidycovid19} package"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="modify-theme-elements-with-theme" class="level2" data-number="11.7"><h2 data-number="11.7" class="anchored" data-anchor-id="modify-theme-elements-with-theme">
<span class="header-section-number">11.7</span> Modify theme elements with <em>theme</em>
</h2>
<p>Theme elements are the <strong>non-data</strong> elements of a graph such as:</p>
<ul>
<li>line</li>
<li>text</li>
<li>title, subtitle, caption</li>
<li>grid (major, minor)</li>
<li>background</li>
<li>ticks</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Syntax of the <code>theme()</code> function
</div>
</div>
<div class="callout-body-container callout-body">
<p>The default display of theme elements can be override by using the <code>theme()</code> function which has two parts in structure, an <strong>element name</strong> and an <strong>element function</strong> in a form similar to:</p>
<blockquote class="blockquote">
<p>theme(<strong>element name</strong> = <strong>element_function</strong>(arguments))</p>
</blockquote>
<p><strong><em>Element name</em></strong></p>
<p>We are able to modify the appearance of theme elements in <strong>plot</strong>, <strong>panel</strong>, <strong>axis</strong>, and <strong>legend</strong> compartments of a simple ggplot graph (<a href="#fig-compartments" class="quarto-xref">Figure&nbsp;<span>11.10</span></a>).</p>
<div id="fig-compartments" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/compartments.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.10: Main compartments in a ggplot graph.</figcaption></figure>
</div>
<p>The theme system enables us to specify the display of elements for a particular compartment of the graph by creating <strong>element names</strong> in the general form of <code>compartment.element</code>. For example, we can specify the title in plot, axis, and legend with the element names <code>plot.title</code>, <code>axis.title</code>, and <code>legend.title</code>, respectfully.</p>
<p><strong><em>Element function</em></strong></p>
<p>Depending on the type of element that we want to modify, there are three pertinent functions that start with <code>element_</code>:</p>
<ul>
<li>
<code>element_line()</code>: specifies the display of lines</li>
<li>
<code>element_text()</code>: specifies the display of text elements</li>
<li>
<code>element_rect()</code>: specifies the display of borders and backgrounds</li>
</ul>
<p><strong>NOTE</strong>: (a) There is also the <code>element_blank()</code> that suppresses the appearance of elements we’re not interested in. (b) Other features of the graph, such as the position of legend, are not specified within an <code>element_function</code>.</p>
<p>&nbsp;</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<p>Suppose we want to change the color (from black to red) and the width of the x-axis line of our graph. The syntax would be similar to:</p>
<div id="fig-theme_ex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/theme_ex.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.11: Main compartments in a ggplot graph.</figcaption></figure>
</div>
</div>
</div>
<p>&nbsp;</p>
<p>Next, we present some examples for each element function to help understanding of the previous concepts.</p>
<section id="a.-element_line" class="level3"><h3 class="anchored" data-anchor-id="a.-element_line">A. element_line()</h3>
<p>With <code>element_line()</code>, we can customize all the lines of the plot that are not part of data. The <a href="#fig-element_line" class="quarto-xref">Figure&nbsp;<span>11.12</span></a> shows the basic line elements (axes, ticks, and grids) that we can control in a simple ggplot graph.</p>
<div id="fig-element_line" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/element_line.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.12: Anatomy of Line Elements in ggplot2.</figcaption></figure>
</div>
<p><strong>1. The <code>X</code> and <code>Y</code> axes lines:</strong></p>
<ul>
<li>both X and Y axes: <code>axis.line = element_line()</code>
</li>
<li>only X axis:<code>axis.line.x = element_line()</code>
</li>
<li>only Y axis:<code>axis.line.y = element_line()</code>
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-linetypes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-linetypes-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.13: dfsfdsfdsf.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="3-4">
<div class="sourceCode" id="cb21" data-source-line-numbers="3-4" data-code-line-numbers="3-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.line.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        axis.line.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-axis1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-axis1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.14: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p>As we can observe, the default line type is a solid line (red x-axis line; <code>linetype = 1</code>). To change the line type, for example from solid to dashed line, we used the <code>linetype = 3</code> option (green y-axis line) (<a href="#fig-axis1" class="quarto-xref">Figure&nbsp;<span>11.14</span></a>).</p>
<p><strong>2. The ticks on <code>X</code> and <code>Y</code> axes:</strong></p>
<ul>
<li>both X and Y ticks: <code>axis.ticks = element_line()</code>
</li>
<li>only X ticks:<code>axis.ticks.x = element_line()</code>
</li>
<li>only Y ticks:<code>axis.ticks.y = element_line()</code>
</li>
</ul>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-source-line-numbers="3-4">
<div class="sourceCode" id="cb22" data-source-line-numbers="3-4" data-code-line-numbers="3-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.ticks.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>        axis.ticks.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>3. The major and minor grid lines of the panel:</strong></p>
<p><strong>Major grid</strong></p>
<ul>
<li>major grid lines (vertical and horizontal): <code>panel.grid.major = element_line()</code>
</li>
<li>major vertical grid lines (cross <code>X</code>): <code>panel.grid.major.x = element_line()</code>
</li>
<li>major horizontal grid lines (cross <code>Y</code>): <code>panel.grid.major.y = element_line()</code>
</li>
</ul>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-source-line-numbers="3-4">
<div class="sourceCode" id="cb23" data-source-line-numbers="3-4" data-code-line-numbers="3-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.major.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span>,</span>
<span>        panel.grid.major.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Minor grid</strong></p>
<ul>
<li>minor grid lines (vertical and horizontal): <code>panel.grid.minor = element_line()</code>
</li>
<li>minor vertical grid lines (cross <code>X</code>): <code>panel.grid.minor.x = element_line()</code>
</li>
<li>minor horizontal grid lines (cross <code>Y</code>): <code>panel.grid.minor.y = element_line()</code>
</li>
</ul>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-source-line-numbers="3-4">
<div class="sourceCode" id="cb24" data-source-line-numbers="3-4" data-code-line-numbers="3-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.minor.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">0.35</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>        panel.grid.minor.y <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, linewidth <span class="op">=</span> <span class="fl">0.35</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also modify the display of both major and minor grids of the ggplot.</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-source-line-numbers="3-4">
<div class="sourceCode" id="cb25" data-source-line-numbers="3-4" data-code-line-numbers="3-4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">0.55</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"deeppink"</span>, linewidth <span class="op">=</span> <span class="fl">0.35</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="ggplot2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="b.-element_text" class="level3"><h3 class="anchored" data-anchor-id="b.-element_text">B. element_text()</h3>
<div id="fig-element_text" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/element_text.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.15: Anatomy of Text Elements in ggplot2.</figcaption></figure>
</div>
<p><strong>1. The title of <code>X</code> and <code>Y</code> axes:</strong></p>
<ul>
<li>X axis:<code>axis.title.x = element_text()</code>
</li>
<li>Y axis:<code>axis.title.y = element_text()</code>
</li>
</ul>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb26" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">18</span>, angle <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-axis_title" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-axis_title-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.16: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb27" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">16</span>, face<span class="op">=</span><span class="st">"bold"</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-axis_text" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-axis_text-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.17: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-14">
<div class="sourceCode" id="cb28" data-source-line-numbers="11-14" data-code-line-numbers="11-14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span>,</span>
<span>        plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>        plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>        plot.tag <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plot_title" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-plot_title-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.18: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb29" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"green"</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-legend_title" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-legend_title-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.19: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
</section><section id="c.-element_rect" class="level3"><h3 class="anchored" data-anchor-id="c.-element_rect">C. element_rect()</h3>
<div id="fig-element_rect" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/element_rect.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;11.20: Anatomy of Text Elements in ggplot2.</figcaption></figure>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb30" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plot_background" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-plot_background-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.21: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb31" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-panel_background" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-panel_background-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.22: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb32" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-legend_background" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-legend_background-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.23: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p><svg aria-hidden="true" role="img" viewbox="0 0 448 512" style="height:1em;width:0.88em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:orange;overflow:visible;position:relative;"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"></path></svg> &nbsp; <strong><em>Example</em></strong></p>
<div class="cell" data-layout-align="center" data-source-line-numbers="11-12">
<div class="sourceCode" id="cb33" data-source-line-numbers="11-12" data-code-line-numbers="11-12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per \ncapita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data"</span>,</span>
<span>       tag <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.key <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"deeppink"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-legend_key" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-legend_key-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11.24: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="themes" class="level2" data-number="11.8"><h2 data-number="11.8" class="anchored" data-anchor-id="themes">
<span class="header-section-number">11.8</span> Themes</h2>
<section id="default-ggplot-theme" class="level3"><h3 class="anchored" data-anchor-id="default-ggplot-theme">Default ggplot theme</h3>
<p>The default theme of ggplot is the <code>theme_gray</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34" data-source-line-numbers="nil" data-code-line-numbers="nil"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, </span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants (log scale)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per capita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data Jonhs Hopkins University"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggthemes0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-ggthemes0-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;11.25: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
</section><section id="predefined-theme" class="level3"><h3 class="anchored" data-anchor-id="predefined-theme">Predefined theme</h3>
<p>We can customize the theme elements of our graph by applying a predefined theme rather than changing everything by hand. There are ready to use themes from the <a href="https://ggplot2.tidyverse.org">ggplot2</a> and <a href="https://github.com/jrnold/ggthemes">ggthemes</a> packages.</p>
<p>Examples of in-build theme from “ggplot2”:</p>
<ul>
<li>
<strong>theme_bw()</strong> – dark on light ggplot2 theme</li>
<li>
<strong>theme_dark()</strong> – lines on a dark background instead of light</li>
<li>
<strong>theme_minimal()</strong> – no background annotations, minimal feel.</li>
<li>
<strong>theme_classic()</strong> – theme with no grid lines.</li>
<li>
<strong>theme_void()</strong> – empty theme with no elements</li>
</ul>
<p>Examples of themes from “ggthemes”:</p>
<ul>
<li>
<strong>theme_economist()</strong> – theme approximates the style of “<a href="https://www.economist.com/">The Economist</a>”.</li>
<li>
<strong>theme_excel_new()</strong> – theme based on current Excel plot defaults.</li>
<li>
<strong>theme_fivethirtyeight()</strong> – theme inspired by <a href="http://fivethirtyeight.com">FiveThirtyEight</a> plots.</li>
<li>
<strong>theme_gdocs()</strong> – theme based on Google Docs Chart defaults.</li>
<li>
<strong>theme_hc()</strong> – theme based on <a href="https://www.highcharts.com/">Highcharts</a> plots.</li>
</ul>
<p>In our case, we will use the <code>theme_fivethirtyeight()</code> from the “ggthemes” to understand how we can handle default themes.</p>
<div class="cell" data-layout-align="center" data-source-line-numbers="14">
<div class="sourceCode" id="cb35" data-source-line-numbers="14" data-code-line-numbers="14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, </span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants (log scale)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per capita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data Jonhs Hopkins University"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_fivethirtyeight</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggthemes" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-ggthemes-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;11.26: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<p>If we take a look at the code for <code>theme_fivethirtyeight</code> (we just run <code>theme_fivethirtyeight</code> in our console to see the code), we’ll observe that <code>axis.title</code> is set to <code>element_blank()</code>. So this theme has no axis titles by default. We’ll need to change this if we want to set X and Y axis titles. You can turn them back on with theme(axis.title = element_text()) you need to change some of the theme settings that are the defaults in theme_fivethirtyeight.</p>
</section><section id="publication-quality-figure" class="level3"><h3 class="anchored" data-anchor-id="publication-quality-figure">Publication Quality Figure</h3>
<p>More customization of plot</p>
<div class="cell" data-layout-align="center" data-source-line-numbers="2,3,8,16-20">
<div class="sourceCode" id="cb36" data-source-line-numbers="2,3,8,16-20" data-code-line-numbers="2,3,8,16-20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, </span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_jco</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants (log scale)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per capita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data Jonhs Hopkins University"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_fivethirtyeight</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">17</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggthemes2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-ggthemes2-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;11.27: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center" data-source-line-numbers="2,7">
<div class="sourceCode" id="cb37" data-source-line-numbers="2,7" data-code-line-numbers="2,7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gdp_capita</span>, y <span class="op">=</span> <span class="va">cases_per_100k</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>size <span class="op">=</span> <span class="va">tests_per_capita</span>, color <span class="op">=</span> <span class="va">region</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, </span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>                  box.padding <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_jco</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"GDP per capita ($) (log scale)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cases per 100,000 inhabitants (log scale)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>       size <span class="op">=</span> <span class="st">"Proportion tested"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Confirmed cases per 100,000 inhabitants, GDP per capita, and COVID-19 testing rate by country"</span>, </span>
<span>       subtitle <span class="op">=</span> <span class="st">"May 20, 2021"</span>, </span>
<span>       caption <span class="op">=</span> <span class="st">"Source Data: Covid-19 related data Jonhs Hopkins University"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_fivethirtyeight</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">17</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggthemes3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="ggplot2_files/figure-html/fig-ggthemes3-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;11.28: fgdfgdfg.</figcaption></figure>
</div>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./transformation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Data transformation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./introduction.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2023, Konstantinos I. Bougioukas</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer><div class="page-columns page-rows-contents page-layout-article"><div class="social-share">
<a href="https://twitter.com/share?url=https://practical-stats-med-r.netlify.app/&amp;text=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="twitter"><i class="fab fa-twitter fa-fw fa-lg"></i></a><a href="https://www.linkedin.com/shareArticle?url=https://practical-stats-med-r.netlify.app/&amp;title=Practical%20Statistics%20in%20Medicine%20with%20R" target="_blank" class="linkedin"><i class="fa-brands fa-linkedin-in fa-fw fa-lg"></i></a><a href="https://www.facebook.com/sharer.php?u=https://practical-stats-med-r.netlify.app/" target="_blank" class="facebook"><i class="fab fa-facebook-f fa-fw fa-lg"></i></a>
</div></div>



<script src="site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>